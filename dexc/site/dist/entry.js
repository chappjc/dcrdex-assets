(()=>{"use strict";var e,t,n,r;function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s,l="ID_NO_PASS_ERROR_MSG",c="ID_NO_APP_PASS_ERROR_MSG",u="ID_SET_BUTTON_BUY",h="ID_SET_BUTTON_SELL",d="ID_OFF",f="ID_READY",p="ID_LOCKED",m="ID_NOWALLET",y="ID_WALLET_SYNC_PROGRESS",v="ID_HIDE_ADDITIONAL_SETTINGS",g="ID_SHOW_ADDITIONAL_SETTINGS",w="ID_BUY",b="ID_SELL",k="ID_NOT_SUPPORTED",x="ID_CONNECTION_FAILED",C="ID_ORDER_PREVIEW",S="ID_CALCULATING",A="ID_ESTIMATE_UNAVAILABLE",E="ID_NO_ZERO_RATE",O="ID_NO_ZERO_QUANTITY",F="ID_TRADE",R="ID_NO_ASSET_WALLET",I="ID_EXECUTED",T="ID_BOOKED",D="ID_CANCELING",P="ID_PASSWORD_NOT_MATCH",L="ID_ACCT_UNDEFINED",B="ID_KEEP_WALLET_PASS",W="ID_NEW_WALLET_PASS",q="ID_LOT",M="ID_LOTS",j="ID_UNKNOWN",_="ID_EPOCH",N="ID_SETTLING",U="ID_NO_MATCH",z="ID_CANCELED",V="ID_REVOKED",H="ID_WAITING_FOR_CONFS",X="ID_NONE_SELECTED",Q="ID_REGISTRATION_FEE_SUCCESS",Y="ID_API_ERROR",G="ID_ADD",K="ID_CREATE",Z="ID_SETUP_WALLET",$="ID_WALLET_READY",J="ID_CHANGE_WALLET_TYPE",ee="ID_KEEP_WALLET_TYPE",te="WALLET_READY",ne="SETUP_NEEDED",re=(a(e={},l,"password cannot be empty"),a(e,c,"app password cannot be empty"),a(e,P,"passwords do not match"),a(e,u,"Place order to buy  {{ asset }}"),a(e,h,"Place order to sell {{ asset }}"),a(e,d,"off"),a(e,f,"ready"),a(e,p,"locked"),a(e,m,"no wallet"),a(e,y,"wallet is {{ syncProgress }}% synced"),a(e,v,"hide additional settings"),a(e,g,"show additional settings"),a(e,w,"Buy"),a(e,b,"Sell"),a(e,k,"{{ asset }} is not supported"),a(e,x,"Connection to dex server failed. You can close dexc and try again later or wait for it to reconnect."),a(e,C,"Total: {{ total }} {{ asset }}"),a(e,S,"calculating..."),a(e,A,"estimate unavailable"),a(e,E,"zero rate not allowed"),a(e,O,"zero quantity not allowed"),a(e,F,"trade"),a(e,R,"No {{ asset }} wallet"),a(e,I,"executed"),a(e,T,"booked"),a(e,D,"canceling"),a(e,L,"Account undefined."),a(e,B,"keep current wallet password"),a(e,W,"set a new wallet password"),a(e,q,"lot"),a(e,M,"lots"),a(e,j,"unknown"),a(e,_,"epoch"),a(e,N,"settling"),a(e,U,"no match"),a(e,z,"canceled"),a(e,V,"revoked"),a(e,H,"Waiting for confirmations..."),a(e,X,"none selected"),a(e,Q,"Registration fee payment successful!"),a(e,Y,"API error"),a(e,G,"Add"),a(e,K,"Create"),a(e,$,"Ready"),a(e,Z,"Setup"),a(e,J,"change the wallet type"),a(e,ee,"don't change the wallet type"),a(e,te,"Wallet Ready"),a(e,ne,"Setup Needed"),e),oe=(a(t={},l,"senha não pode ser vazia"),a(t,c,"senha do app não pode ser vazia"),a(t,P,"senhas diferentes"),a(t,u,"Ordem de compra de {{ asset }}"),a(t,h,"Ordem de venda de {{ asset }}"),a(t,d,"desligar"),a(t,f,"pronto"),a(t,p,"trancado"),a(t,m,"sem carteira"),a(t,y,"carteira está {{ syncProgress }}% sincronizada"),a(t,v,"esconder configurações adicionais"),a(t,g,"mostrar configurações adicionais"),a(t,w,"Comprar"),a(t,b,"Vender"),a(t,k,"{{ asset }} não tem suporte"),a(t,x,"Conexão ao server dex falhou. Pode fechar dexc e tentar novamente depois ou esperar para tentar se reconectar."),a(t,C,"Total: {{ total }} {{ asset }}"),a(t,S,"calculando..."),a(t,A,"estimativa indisponível"),a(t,E,"taxa não pode ser zero"),a(t,O,"quantidade não pode ser zero"),a(t,F,"troca"),a(t,R,"Sem carteira {{ asset }}"),a(t,I,"executado"),a(t,T,"reservado"),a(t,D,"cancelando"),a(t,L,"conta não definida."),a(t,B,"manter senha da carteira"),a(t,W,"definir nova senha para carteira"),a(t,q,"lote"),a(t,M,"lotes"),a(t,j,"desconhecido"),a(t,_,"epoque"),a(t,N,"assentando"),a(t,U,"sem combinações"),a(t,z,"cancelado"),a(t,V,"revocado"),a(t,H,"Esperando confirmações..."),a(t,X,"nenhuma selecionado"),a(t,Q,"Sucesso no pagamento da taxa de registro!"),a(t,Y,"Erro de API"),a(t,G,"Adicionar"),a(t,K,"Criar"),a(t,$,"Escolher"),a(t,Z,"Configurar"),a(t,J,"trocar o tipo de carteira"),a(t,ee,"Não trocara tipo de carteira"),a(t,te,"Carteira Pronta"),a(t,ne,"Configuração Necessária"),t),ie=(a(n={},l,"密码不能为空"),a(n,c,"应用密码不能为空"),a(n,P,"密码不相同"),a(n,u,"来自{{ asset }}的买入订单"),a(n,h,"来自{{ asset }}的卖出订单"),a(n,d,"关闭"),a(n,f,"准备就绪"),a(n,p,"锁定"),a(n,m,"未连接钱包"),a(n,y,"钱包同步进度{{ syncProgress }}%"),a(n,v,"隐藏其它设置"),a(n,g,"显示其它设置"),a(n,w,"买"),a(n,b,"卖"),a(n,k,"{{ asset }}不受支持"),a(n,x,"连接到服务器 dex 失败。您可以关闭 dexc 并稍后重试或等待尝试重新连接。"),a(n,C,"总计： {{ total }} {{ asset }}"),a(n,S,"计算中..."),a(n,A,"估计不可用"),a(n,E,"汇率不能为零"),a(n,O,"数量不能为零"),a(n,F,"交易"),a(n,R,"没有钱包 {{ asset }}"),a(n,I,"执行"),a(n,T,"保留"),a(n,D,"取消"),a(n,L,"帐户未定义。"),a(n,B,"保留钱包密码"),a(n,W,"设置新的钱包密码"),a(n,q,"批处理"),a(n,M,"批"),a(n,j,"unknown"),a(n,_,"时间"),a(n,N,"settling"),a(n,U,"no match"),a(n,z,"canceled"),a(n,V,"revoked"),a(n,H,"Waiting for confirmations..."),a(n,X,"none selected"),a(n,Q,"Registration fee payment successful!"),a(n,Y,"接口错误"),a(n,G,"加"),a(n,K,"创建"),a(n,$,"Choose Wallet"),a(n,Z,"Setup"),n),ae=(a(r={},l,"hasło nie może być puste"),a(r,c,"hasło aplikacji nie może być puste"),a(r,P,"hasła nie są jednakowe"),a(r,u,"Złóż zlecenie, aby kupić  {{ asset }}"),a(r,h,"Złóż zlecenie, aby sprzedać {{ asset }}"),a(r,d,"wyłączony"),a(r,f,"gotowy"),a(r,p,"zablokowany"),a(r,m,"brak portfela"),a(r,y,"portfel zsynchronizowany w {{ syncProgress }}%"),a(r,v,"ukryj dodatkowe ustawienia"),a(r,g,"pokaż dodatkowe ustawienia"),a(r,w,"Kup"),a(r,b,"Sprzedaj"),a(r,k,"{{ asset }} nie jest wspierany"),a(r,x,"Połączenie z serwerem dex nie powiodło się. Możesz zamknąć dexc i spróbować ponownie później, lub poczekać na wznowienie połączenia."),a(r,C,"W sumie: {{ total }} {{ asset }}"),a(r,S,"obliczanie..."),a(r,A,"brak szacunkowego wyliczenia"),a(r,E,"zero nie może być ceną"),a(r,O,"zero nie może być ilością"),a(r,F,"handluj"),a(r,R,"Brak portfela {{ asset }}"),a(r,I,"wykonano"),a(r,T,"zapisano"),a(r,D,"anulowanie"),a(r,L,"Niezdefiniowane konto."),a(r,B,"zachowaj obecne hasło portfela"),a(r,W,"ustaw nowe hasło portfela"),a(r,q,"lot"),a(r,M,"loty(ów)"),a(r,j,"nieznane"),a(r,_,"epoka"),a(r,N,"rozliczanie"),a(r,U,"brak spasowania"),a(r,z,"anulowano"),a(r,V,"unieważniono"),a(r,H,"Oczekiwanie na potwierdzenia..."),a(r,X,"brak zaznaczenia"),a(r,Q,"Płatność rejestracyjna powiodła się!"),a(r,Y,"błąd API"),a(r,G,"Dodaj"),a(r,K,"Utwórz"),a(r,$,"Gotowy"),a(r,Z,"Konfiguracja"),a(r,J,"zmień typ portfela"),a(r,ee,"nie zmieniaj typu portfela"),a(r,te,"Portfel jest gotowy"),a(r,ne,"Potrzebna konfiguracja"),r),se={"en-us":re,"pt-br":oe,"zh-cn":ie,"pl-pl":ae},le=re;function ce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return ue(s[e]||le[e],t)}function ue(e,t){return e.replace(/{{\s?([^{}\s]*)\s?}}/g,(function(e,n){return t[n]}))}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||fe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=fe(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function fe(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function me(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ge(e,t,n){return t&&ve(e.prototype,t),n&&ve(e,n),e}window.localeDiscrepancies=function(){for(var e=re,t=0,n=Object.entries(se);t<n.length;t++){var r=o(n[t],2),i=r[0],a=r[1];if(a!==e)for(var s=0,l=Object.entries(e);s<l.length;s++){var c=o(l[s],2),u=c[0],h=c[1];a[u]||console.log("".concat(i," needs a tranlation for: ").concat(h))}}};var we=new window.DOMParser,be=Object.values({0:"btc",42:"dcr",2:"ltc",22:"mona",28:"vtc",3:"doge",145:"bch",60:"eth"}),ke=new Intl.NumberFormat(navigator.languages),xe={},Ce={};function Se(e,t,n){var r="".concat(t,"-").concat(n),o=e[r];return o||(o=new Intl.NumberFormat(navigator.languages,{minimumFractionDigits:t,maximumFractionDigits:n}),e[r]=o),o}function Ae(e,t){var n=8;if(t){var r=t.conventional.conversionFactor;e/=r,n=Math.round(Math.log10(r))}return[e,n]}var Ee=function(){function e(){ye(this,e)}var t,n;return ge(e,null,[{key:"idel",value:function(e,t){return e.querySelector("#".concat(t))}},{key:"bind",value:function(e,t,n){e.addEventListener(t,n)}},{key:"unbind",value:function(e,t,n){e.removeEventListener(t,n)}},{key:"noderize",value:function(e){return we.parseFromString(e,"text/html")}},{key:"mouseInElement",value:function(e,t){var n=t.getBoundingClientRect();return e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom}},{key:"layoutMetrics",value:function(e){var t=e.getBoundingClientRect(),n=document.documentElement,r=t.top+n.scrollTop,o=t.left+n.scrollLeft,i=e.offsetWidth,a=e.offsetHeight;return{bodyTop:r,bodyLeft:o,width:i,height:a,centerX:o+i/2,centerY:r+a/2}}},{key:"empty",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,o=t;r<o.length;r++)for(var i=o[r];i.firstChild;)i.removeChild(i.firstChild)}},{key:"hide",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,o=t;r<o.length;r++){var i=o[r];i.classList.add("d-hide")}}},{key:"show",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,o=t;r<o.length;r++){var i=o[r];i.classList.remove("d-hide")}}},{key:"isHidden",value:function(e){return e.classList.contains("d-hide")}},{key:"isDisplayed",value:function(e){return!e.classList.contains("d-hide")}},{key:"animate",value:(t=function*(e,t,n){for(var r=n?Oe[n]:Oe.linear,o=(new Date).getTime(),i=o+e,a=i-o,s=o;s<i;)t(r((s-o)/a)),yield Re(33.333333333333336),s=(new Date).getTime();t(1)},n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){me(i,r,o,a,s,"next",e)}function s(e){me(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e,t,r){return n.apply(this,arguments)})},{key:"idDescendants",value:function(e){var t,n={},r=de(e.querySelectorAll("[id]"));try{for(r.s();!(t=r.n()).done;){var o=t.value;n[o.id]=o}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"formatCoinValue",value:function(e,t){var n=he(Ae(e,t),2),r=n[0],o=n[1];return Number.isInteger(r)?ke.format(r):function(e){return Se(xe,2,e)}(o).format(r)}},{key:"formatFullPrecision",value:function(e,t){var n,r=he(Ae(e,t),2),o=r[0];return(n=r[1],Se(Ce,n,n)).format(o)}},{key:"logoPath",value:function(e){return-1===be.indexOf(e)&&(e=e.substring(0,1)),"/img/coins/".concat(e,".png")}},{key:"cleanTemplates",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e.remove(),e.removeAttribute("id")}))}},{key:"tmplElement",value:function(e,t){return e.querySelector('[data-tmpl="'.concat(t,'"]'))}},{key:"parseTemplate",value:function(e){var t,n={},r=de(e.querySelectorAll("[data-tmpl]"));try{for(r.s();!(t=r.n()).done;){var o=t.value;n[o.dataset.tmpl]=o}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"timeSince",value:function(t){return e.formatDuration((new Date).getTime()-t)}},{key:"formatDuration",value:function(e){var t,n,r,o,i,a,s=Math.floor(e),l="",c=0,u=function(e,t){return(e>0||c>0)&&c++,e>0&&(l+="".concat(e," ").concat(t," ")),c>=2},h=he(Be(s,Ie),2);if(t=h[0],s=h[1],u(t,"y"))return l;var d=he(Be(s,Te),2);if(n=d[0],s=d[1],u(n,"mo"))return l;var f=he(Be(s,De),2);if(r=f[0],s=f[1],u(r,"d"))return l;var p=he(Be(s,Pe),2);if(o=p[0],s=p[1],u(o,"h"))return l;var m=he(Be(s,Le),2);if(i=m[0],s=m[1],u(i,"m"))return l;var y=he(Be(s,1e3),2);return a=y[0],s=y[1],u(a,"s"),l||"0 s"}},{key:"disableMouseWheel",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,o=t;r<o.length;r++){var i=o[r];i.addEventListener("wheel",(function(e){e.preventDefault()}))}}}]),e}(),Oe={linear:function(e){return e},easeIn:function(e){return e*e},easeOut:function(e){return e*(2-e)},easeInHard:function(e){return e*e*e},easeOutHard:function(e){return--e*e*e+1}},Fe=function(){function e(t){ye(this,e);var n=function(e){return t.querySelector("[data-state=".concat(e,"]"))};this.icons={},this.icons.sleeping=n("sleeping"),this.icons.locked=n("locked"),this.icons.unlocked=n("unlocked"),this.icons.nowallet=n("nowallet"),this.icons.syncing=n("syncing"),this.icons.nopeers=n("nopeers"),this.status=n("status")}return ge(e,[{key:"sleeping",value:function(){var e=this.icons;Ee.hide(e.locked,e.unlocked,e.nowallet,e.syncing),Ee.show(e.sleeping),this.status&&(this.status.textContent=ce(d))}},{key:"locked",value:function(){var e=this.icons;Ee.hide(e.unlocked,e.nowallet,e.sleeping),Ee.show(e.locked),this.status&&(this.status.textContent=ce(p))}},{key:"unlocked",value:function(){var e=this.icons;Ee.hide(e.locked,e.nowallet,e.sleeping),Ee.show(e.unlocked),this.status&&(this.status.textContent=ce(f))}},{key:"nowallet",value:function(){var e=this.icons;Ee.hide(e.locked,e.unlocked,e.sleeping,e.syncing),Ee.show(e.nowallet),this.status&&(this.status.textContent=ce(m))}},{key:"setSyncing",value:function(e){var t=this.icons.syncing;if(e&&e.running){if(0===e.peerCount)return Ee.show(this.icons.nopeers),void Ee.hide(t);if(Ee.hide(this.icons.nopeers),!e.synced)return Ee.show(t),void(t.dataset.tooltip=ce(y,{syncProgress:(100*e.syncProgress).toFixed(1)}));Ee.hide(t)}else Ee.hide(t)}},{key:"readWallet",value:function(e){switch(this.setSyncing(e),!0){case!e:this.nowallet();break;case!e.running:this.sleeping();break;case!e.open:this.locked();break;case e.open:this.unlocked();break;default:console.error("wallet in unknown state",e)}}}]),e}();function Re(e){return new Promise((function(t){return setTimeout(t,e)}))}var Ie=31536e6,Te=2592e6,De=864e5,Pe=36e5,Le=6e4;function Be(e,t){var n=Math.floor(e/t);return[n,e-n*t]}function We(e,t){if(e){if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qe(e,t):void 0}}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var je,_e="darkMode",Ne="popups",Ue=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"setCookie",value:function(e,t){var n=new Date;n.setTime(n.getTime()+31536e7);var r="expires="+n.toUTCString();document.cookie=e+"="+t+";"+r+";path=/"}},{key:"getCookie",value:function(e){var t,n,r,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=We(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(document.cookie.split(";"));try{for(o.s();!(t=o.n()).done;){var i=(n=t.value.split("="),r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||We(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1];if(a.trim()===e)return s}}catch(e){o.e(e)}finally{o.f()}return null}},{key:"dark",value:function(e){this.setCookie(_e,e?"1":"0"),e?document.body.classList.add("dark"):document.body.classList.remove("dark")}},{key:"isDark",value:function(){return document.cookie.split(";").filter((function(e){return e.includes("".concat(_e,"=1"))})).length}},{key:"passwordIsCached",value:function(){return!!this.getCookie("sessionkey")}},{key:"store",value:function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}},{key:"clearAllStore",value:function(){window.localStorage.clear()}},{key:"removeAuthCK",value:function(){document.cookie="".concat("dexauth","=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")}},{key:"fetch",value:function(e){var t=window.localStorage.getItem(e);return null!==t?JSON.parse(t):null}}],null&&Me(t.prototype,null),n&&Me(t,n),e}();function ze(){return je}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}null===Ue.getCookie(_e)&&Ue.setCookie(_e,"1"),null===Ue.getCookie(Ne)&&Ue.setCookie(Ne,"1");var He=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"notify",value:function(e){this.notifiers&&this.notifiers[e.type]&&this.notifiers[e.type](e)}},{key:"unload",value:function(){}}])&&Ve(t.prototype,n),e}();function Xe(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Qe(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Xe(i,r,o,a,s,"next",e)}function s(e){Xe(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Ye(e,t,n){return Ge.apply(this,arguments)}function Ge(){return(Ge=Qe((function*(e,t,n){try{var r=yield window.fetch(t,{method:e,headers:new window.Headers({"content-type":"application/json"}),body:n});if(200!==r.status)throw r;var o=yield r.json();return o.requestSuccessful=!0,o}catch(r){return r.requestSuccessful=!1,r.msg=yield r.text(),r}}))).apply(this,arguments)}function Ke(e,t){return Ze.apply(this,arguments)}function Ze(){return(Ze=Qe((function*(e,t){return Ye("POST",e,JSON.stringify(t))}))).apply(this,arguments)}function $e(){return($e=Qe((function*(e){return Ye("GET",e)}))).apply(this,arguments)}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var et=1e8;function tt(e){return e.sell?"sell":"buy"}function nt(e){return 1===e.type?0===e.tif?"limit (i)":"limit":"market"}function rt(e){return 2===e.type&&!e.sell}function ot(e){var t=function(e){if(!e.matches)return!1;var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Je(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.matches);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!r.revoked&&r.status<3)return!0}}catch(e){n.e(e)}finally{n.f()}return!1}(e);switch(e.status){case 0:return ce(j);case 1:return ce(_);case 2:return e.cancelling?ce(D):t?"".concat(ce(T),"/").concat(ce(N)):ce(T);case 3:return t?ce(N):0===e.filled?ce(U):ce(I);case 4:return t?"".concat(ce(z),"/").concat(ce(N)):ce(z);case 5:return t?"".concat(ce(V),"/").concat(ce(N)):ce(V)}}function it(e){if(!e.matches)return 0;var t=rt(e)?function(e){return e.qty*e.rate/et}:function(e){return e.qty};return e.matches.reduce((function(e,n){return n.isCancel?e:0===n.side&&n.status>=3||1===n.side&&n.status>=4?e+t(n):e}),0)}function at(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ut(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function st(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function lt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){st(i,r,o,a,s,"next",e)}function s(e){st(i,r,o,a,s,"throw",e)}a(void 0)}))}}function ct(e){return function(e){if(Array.isArray(e))return ht(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ut(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){if(e){if("string"==typeof e)return ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ht(e,t):void 0}}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t,n){return t&&ft(e.prototype,t),n&&ft(e,n),e}var mt=function(){function e(t,n,r,o){var i=this;dt(this,e),this.form=t,this.success=n,this.pwCache=r,this.currentAsset=null;var a=this.page=Ee.parseTemplate(t);this.pwHiders=Array.from(t.querySelectorAll(".hide-pw")),this.refresh(),o&&(Ee.show(a.goBack),Ee.bind(a.goBack,"click",(function(){o()}))),Ee.empty(a.walletTabTmpl),a.walletTabTmpl.removeAttribute("id"),this.subform=new yt(a.walletSettings,!0),Ee.bind(this.subform.showOther,"click",(function(){return Ee.show(a.walletSettingsHeader)})),Et(t,a.submitAdd,(function(){return i.submit()})),Et(t,a.oneBttn,(function(){return i.submit()}))}var t,n,r,o,i;return pt(e,[{key:"refresh",value:function(){Ue.passwordIsCached()||this.pwCache&&this.pwCache.pw?Ee.hide.apply(Ee,ct(this.pwHiders)):Ee.show.apply(Ee,ct(this.pwHiders))}},{key:"submit",value:(i=lt((function*(){var e=this.page,t=e.appPass.value||(this.pwCache?this.pwCache.pw:"");if(!t&&!Ue.passwordIsCached())return e.newWalletErr.textContent=ce(c),void Ee.show(e.newWalletErr);Ee.hide(e.newWalletErr);var n=parseInt(this.currentAsset.id),r={assetID:n,pass:e.newWalletPass.value||"",config:this.subform.map(),appPass:t,walletType:this.currentWalletType};e.appPass.value="";var o=ze().loading(e.mainForm),i=yield Ke("/api/newwallet",r);o(),ze().checkResponse(i)?(this.pwCache&&(this.pwCache.pw=t),e.newWalletPass.value="",this.success(n)):this.setError(i.msg)})),function(){return i.apply(this,arguments)})},{key:"setAsset",value:(o=lt((function*(e){var t=this,n=this.page,r=ze().assets[e],o=n.walletTypeTabs;if(!this.currentAsset||this.currentAsset.id!==r.id){this.currentAsset=r,n.assetLogo.src=Ee.logoPath(r.symbol),n.assetName.textContent=r.info.name,n.newWalletPass.value="",r.info.availablewallets.length>1?n.header.classList.add("bordertop"):n.header.classList.remove("bordertop");var i=r.info.availablewallets[0];if(Ee.empty(o),Ee.hide(o,n.newWalletErr),r.info.availablewallets.length>1){Ee.show(o);var a,s=at(r.info.availablewallets);try{var l=function(){var e=a.value,r=n.walletTabTmpl.cloneNode(!0);r.dataset.tooltip=e.description,r.textContent=e.tab,o.appendChild(r),Ee.bind(r,"click",(function(){var n,i=at(o.children);try{for(i.s();!(n=i.n()).done;)n.value.classList.remove("selected")}catch(e){i.e(e)}finally{i.f()}r.classList.add("selected"),t.update(e)}))};for(s.s();!(a=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}ze().bindTooltips(o),o.firstChild.classList.add("selected")}yield this.update(i)}})),function(e){return o.apply(this,arguments)})},{key:"update",value:(r=lt((function*(e){var t=this.page;this.currentWalletType=e.type;var n=Ue.passwordIsCached()||this.pwCache&&this.pwCache.pw;Ee.hide(t.auth,t.oneBttnBox,t.newWalletPassBox),n&&e.seeded?Ee.show(t.oneBttnBox):e.seeded?(Ee.show(t.auth),t.newWalletPass.value="",t.submitAdd.textContent=ce(K)):(Ee.show(t.auth,t.newWalletPassBox),t.submitAdd.textContent=ce(G)),this.subform.update(e.configopts||[]),this.subform.dynamicOpts.children.length?Ee.show(t.walletSettingsHeader):Ee.hide(t.walletSettingsHeader),this.refresh(),yield this.loadDefaults()})),function(e){return r.apply(this,arguments)})},{key:"setError",value:(n=lt((function*(e){this.page.newWalletErr.textContent=e,Ee.show(this.page.newWalletErr)})),function(e){return n.apply(this,arguments)})},{key:"loadDefaults",value:(t=lt((function*(){if(!ze().walletDefinition(this.currentAsset.id,this.currentWalletType).seeded){var e=ze().loading(this.form),t=yield Ke("/api/defaultwalletcfg",{assetID:this.currentAsset.id,type:this.currentWalletType});e(),ze().checkResponse(t)?this.subform.setLoadedConfig(t.config):this.setError(t.msg)}})),function(){return t.apply(this,arguments)})}]),e}(),yt=function(){function e(t,n){var r=this;dt(this,e),this.form=t,this.configElements={},this.configOpts=[],this.sectionize=n,this.allSettings=Ee.tmplElement(t,"allSettings"),this.dynamicOpts=Ee.tmplElement(t,"dynamicOpts"),this.textInputTmpl=Ee.tmplElement(t,"textInput"),this.textInputTmpl.remove(),this.checkboxTmpl=Ee.tmplElement(t,"checkbox"),this.checkboxTmpl.remove(),this.fileSelector=Ee.tmplElement(t,"fileSelector"),this.fileInput=Ee.tmplElement(t,"fileInput"),this.errMsg=Ee.tmplElement(t,"errMsg"),this.showOther=Ee.tmplElement(t,"showOther"),this.showIcon=Ee.tmplElement(t,"showIcon"),this.hideIcon=Ee.tmplElement(t,"hideIcon"),this.showHideMsg=Ee.tmplElement(t,"showHideMsg"),this.otherSettings=Ee.tmplElement(t,"otherSettings"),this.loadedSettingsMsg=Ee.tmplElement(t,"loadedSettingsMsg"),this.loadedSettings=Ee.tmplElement(t,"loadedSettings"),this.defaultSettingsMsg=Ee.tmplElement(t,"defaultSettingsMsg"),this.defaultSettings=Ee.tmplElement(t,"defaultSettings"),n||Ee.hide(this.showOther),Ee.bind(this.fileSelector,"click",(function(){return r.fileInput.click()})),Ee.bind(this.fileInput,"change",lt((function*(){return r.fileInputChanged()}))),Ee.bind(this.showOther,"click",(function(){r.setOtherSettingsViz(r.hideIcon.classList.contains("d-hide"))}))}var t;return pt(e,[{key:"fileInputChanged",value:(t=lt((function*(){var e;if(Ee.hide(this.errMsg),this.fileInput.value){var t=ze().loading(this.form),n=yield this.fileInput.files[0].text();if(n){var r=yield Ke("/api/parseconfig",{configtext:n});if(t(),!ze().checkResponse(r))return this.errMsg.textContent=r.msg,void Ee.show(this.errMsg);if(0!==Object.keys(r.map).length){(e=this.dynamicOpts).append.apply(e,ct(this.setConfig(r.map))),this.reorder(this.dynamicOpts);var o=[this.loadedSettings.children.length,this.defaultSettings.children.length],i=o[0],a=o[1];0===i&&Ee.hide(this.loadedSettings,this.loadedSettingsMsg),0===a&&Ee.hide(this.defaultSettings,this.defaultSettingsMsg),i+a===0&&Ee.hide(this.showOther,this.otherSettings)}}}})),function(){return t.apply(this,arguments)})},{key:"update",value:function(e){var t=this;if(this.configElements={},this.configOpts=e,Ee.empty(this.dynamicOpts,this.defaultSettings,this.loadedSettings),0===e.length)return Ee.hide(this.form);Ee.show(this.form),this.setOtherSettingsViz(!1),Ee.hide(this.loadedSettingsMsg,this.loadedSettings,this.defaultSettingsMsg,this.defaultSettings,this.errMsg);var n,r=[],o=function(e,n){var r="wcfg-"+n.key,o=n.isboolean?t.checkboxTmpl.cloneNode(!0):t.textInputTmpl.cloneNode(!0);t.configElements[n.key]=o;var i=o.querySelector("input");i.id=r,i.configOpt=n;var a=o.querySelector("label");a.htmlFor=r,a.prepend(n.displayname),e.appendChild(o),n.noecho&&(i.type="password"),n.description&&(a.dataset.tooltip=n.description),n.isboolean?i.checked=n.default:i.value=null!==n.default?n.default:""},i=at(this.configOpts);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.sectionize&&null!==a.default?r.push(a):o(this.dynamicOpts,a)}}catch(e){i.e(e)}finally{i.f()}if(r.length){var s,l=at(r);try{for(l.s();!(s=l.n()).done;){var c=s.value;o(this.defaultSettings,c)}}catch(e){l.e(e)}finally{l.f()}Ee.show(this.showOther,this.defaultSettingsMsg,this.defaultSettings)}else Ee.hide(this.showOther);ze().bindTooltips(this.allSettings),this.dynamicOpts.children.length?Ee.show(this.dynamicOpts):Ee.hide(this.dynamicOpts)}},{key:"setOtherSettingsViz",value:function(e){if(e)return Ee.hide(this.showIcon),Ee.show(this.hideIcon,this.otherSettings),void(this.showHideMsg.textContent=ce(v));Ee.hide(this.hideIcon,this.otherSettings),Ee.show(this.showIcon),this.showHideMsg.textContent=ce(g)}},{key:"setConfig",value:function(e){var t=this,n=[];return this.allSettings.querySelectorAll("input").forEach((function(r){var o,i=r.configOpt.key,a=e[i];void 0!==a&&(n.push(t.configElements[i]),r.configOpt.isboolean?r.checked="1"===(o=a)||"true"===o.toLowerCase():r.value=a)})),n}},{key:"setLoadedConfig",value:function(e){var t,n=this.setConfig(e);this.sectionize&&0!==n.length&&((t=this.loadedSettings).append.apply(t,ct(n)),this.reorder(this.loadedSettings),Ee.show(this.loadedSettings,this.loadedSettingsMsg),0===this.defaultSettings.children.length&&Ee.hide(this.defaultSettings,this.defaultSettingsMsg))}},{key:"map",value:function(){var e={};return this.allSettings.querySelectorAll("input").forEach((function(t){t.configOpt.isboolean&&t.configOpt.key?e[t.configOpt.key]=t.checked?"1":"0":t.value&&(e[t.configOpt.key]=t.value)})),e}},{key:"reorder",value:function(e){var t=this,n={};e.querySelectorAll("input").forEach((function(e){var r=e.configOpt.key;n[r]=t.configElements[r]}));var r,o=at(this.configOpts);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=n[i.key];a&&e.append(a)}}catch(e){o.e(e)}finally{o.f()}}}]),e}(),vt=function(){function e(t,n,r,o){var i=this;dt(this,e),this.form=t,this.success=n,this.page=Ee.parseTemplate(t),this.xc=null,this.certFile="",this.feeAssetID=null,this.pwCache=o,Ee.bind(this.page.goBack,"click",(function(){return r()})),Et(t,this.page.submit,(function(){return i.submitForm()}))}var t,n;return pt(e,[{key:"setExchange",value:function(e,t){this.xc=e,this.certFile=t;var n=this.page;Ue.passwordIsCached()||this.pwCache&&this.pwCache.pw?Ee.hide(n.passBox):Ee.show(n.passBox),n.host.textContent=e.host}},{key:"setAsset",value:function(e){var t=ze().assets[e],n=t.info.unitinfo;this.feeAssetID=t.id;var r=this.page,o=this.xc.regFees[t.symbol];r.fee.textContent=Ee.formatCoinValue(o.amount,n),r.feeUnit.textContent=n.conventional.unit.toUpperCase(),r.logo.src=Ee.logoPath(t.symbol)}},{key:"animate",value:(n=lt((function*(){var e=this.form;Ee.animate(400,(function(t){e.style.transform="scale(".concat(t,")"),e.style.opacity=Math.pow(t,4);var n="".concat(500*(1-t),"px");e.style.top=n,e.style.left=n}))})),function(){return n.apply(this,arguments)})},{key:"submitForm",value:(t=lt((function*(){var e=this.page;if(e.submit.classList.contains("selected")){if(null===this.feeAssetID)return e.regErr.innerText="You must select a valid wallet for the fee payment",void Ee.show(e.regErr);var t=ze().user.assets[this.feeAssetID].wallet.symbol;Ee.hide(e.regErr);var n=this.xc.regFees[t],r=yield this.certFile,o={addr:this.xc.host,pass:e.appPass.value||(this.pwCache?this.pwCache.pw:""),fee:n.amount,asset:n.id,cert:r};e.appPass.value="";var i=ze().loading(this.form),a=yield Ke("/api/register",o);if(i(),!ze().checkResponse(a))return e.regErr.textContent=a.msg,void Ee.show(e.regErr);this.success()}})),function(){return t.apply(this,arguments)})}]),e}(),gt=function(){function e(t,n){dt(this,e),this.form=t,this.success=n,this.xc=null,this.page=Ee.parseTemplate(t),Ee.cleanTemplates(this.page.marketTmpl,this.page.assetTmpl)}var t;return pt(e,[{key:"setExchange",value:function(e){var t=this;this.xc=e;var n=this.page;Ee.empty(n.assets,n.allMarkets);for(var r=function(e){return e.conventional.conversionFactor},o=function(t,o){var i=n.marketTmpl.cloneNode(!0),a=Ee.parseTemplate(i),s=e.assets[t.baseid],l=ze().unitInfo(t.baseid,e),c=e.assets[t.quoteid],u=ze().unitInfo(t.quoteid,e);if(0===r(l)||0===r(u))return null;if(void 0!==o){var h=o===t.baseid,d=e.assets[h?t.quoteid:t.baseid].symbol;a.logo.src=Ee.logoPath(d)}else{var f=a.logo.cloneNode(!0);a.logo.src=Ee.logoPath(s.symbol),f.src=Ee.logoPath(c.symbol),a.logo.parentNode.insertBefore(f,a.logo.nextSibling)}var p=s.symbol.toUpperCase(),m=c.symbol.toUpperCase();a.name.textContent="".concat(p,"-").concat(m);var y=Ee.formatCoinValue(t.lotsize,l);if(a.lotSize.textContent="".concat(y," ").concat(p),t.spot){Ee.show(a.quoteLotSize);var v=r(u)/r(l),g=t.lotsize*t.spot.rate/et*v,w=Ee.formatCoinValue(g,u);a.quoteLotSize.textContent="(~".concat(w," ").concat(m,")")}return i},i=function(){var r,i,l=(r=s[a],i=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,i)||ut(r,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],u=l[1],h=ze().assets[u.id];if(!h)return"continue";var d=h.wallet,f=h.info.unitinfo,p=n.assetTmpl.cloneNode(!0);Ee.bind(p,"click",(function(){t.success(u.id)}));var m=Ee.parseTemplate(p);n.assets.appendChild(p),m.logo.src=Ee.logoPath(c);var y=Ee.formatCoinValue(u.amount,f);m.fee.textContent="".concat(y," ").concat(f.conventional.unit),m.confs.textContent=u.confs,m.ready.textContent=ce(d?te:ne),m.ready.classList.add(d?"readygreen":"setuporange");for(var v=0,g=0,w=Object.values(e.markets);g<w.length;g++){var b=w[g];if(b.baseid===u.id||b.quoteid===u.id){var k=o(b,u.id);k&&(v++,m.markets.appendChild(k))}}v<3&&Ee.hide(m.fader)},a=0,s=Object.entries(e.regFees);a<s.length;a++)i();n.host.textContent=e.host;for(var l=0,c=Object.values(e.markets);l<c.length;l++){var u=c[l],h=o(u);h&&n.allMarkets.appendChild(h)}}},{key:"refresh",value:function(){this.setExchange(this.xc)}},{key:"animate",value:(t=lt((function*(){var e=this.page,t=this.form,n=e.how,r=Array.from(e.assets.children);r.push(e.allmkts),t.style.opacity="0",yield Ee.animate(350,(function(e){var o,i=at(r);try{for(i.s();!(o=i.n()).done;){var a=o.value;a.style.marginTop="".concat(75*(1-e),"px"),a.style.transform="scale(".concat(e,")")}}catch(e){i.e(e)}finally{i.f()}t.style.opacity=Math.pow(e,4).toFixed(1),t.style.paddingTop="".concat(50*(1-e),"px"),n.style.fontSize="".concat(24*e,"px")}),"easeOut")})),function(){return t.apply(this,arguments)})}]),e}(),wt=function(){function e(t,n,r){var o=this;dt(this,e),this.form=t,this.success=n,this.page=Ee.parseTemplate(t),this.assetID=-1,this.xc=null,this.regFee=null,this.progressCache=[],this.progressed=!1,this.funded=!1,Ee.bind(this.page.goBack,"click",(function(){o.assetID=-1,r()}))}return pt(e,[{key:"setExchange",value:function(e){this.xc=e}},{key:"setWallet",value:function(e){this.assetID=e.assetID,this.progressCache=[],this.progressed=!1,this.funded=!1;var t,n=this.page,r=ze().assets[e.assetID],o=this.regFee=this.xc.regFees[r.symbol],i=at(this.form.querySelectorAll(".unit"));try{for(i.s();!(t=i.n()).done;)t.value.textContent=r.symbol.toUpperCase()}catch(e){i.e(e)}finally{i.f()}n.logo.src=Ee.logoPath(r.symbol),n.depoAddr.textContent=e.address,n.fee.textContent=Ee.formatCoinValue(o.amount,r.info.unitinfo),Ee.hide(n.syncUncheck,n.syncCheck,n.balUncheck,n.balCheck,n.syncRemainBox),Ee.show(n.balanceBox,n.sendEnough),Ee.show(e.synced?n.syncCheck:e.syncProgress>=1?n.syncSpinner:n.syncUncheck),Ee.show(e.balance.available>o.amount?n.balCheck:n.balUncheck),n.progress.textContent=Math.round(100*e.syncProgress),e.synced&&(this.progressed=!0),this.reportBalance(e.balance,e.assetID)}},{key:"reportWalletState",value:function(e){e.assetID===this.assetID&&(this.progressed&&this.funded||(this.reportProgress(e.synced,e.syncProgress),this.reportBalance(e.balance,e.assetID)))}},{key:"reportBalance",value:function(e,t){if(!this.funded&&-1!==this.assetID&&this.assetID===t){var n=this.page,r=ze().assets[this.assetID];e.available<=this.regFee.amount?n.balance.textContent=Ee.formatCoinValue(e.available,r.info.unitinfo):(Ee.show(n.balCheck),Ee.hide(n.balUncheck,n.balanceBox,n.sendEnough),this.funded=!0,this.progressed&&this.success())}}},{key:"reportProgress",value:function(e,t){var n=this.page;if(e)return n.progress.textContent="100",Ee.hide(n.syncUncheck,n.syncRemainBox,n.syncSpinner),Ee.show(n.syncCheck),this.progressed=!0,void(this.funded&&this.success());1===t?(Ee.hide(n.syncUncheck),Ee.show(n.syncSpinner)):(Ee.hide(n.syncSpinner),Ee.show(n.syncUncheck)),n.progress.textContent=Math.round(100*t);var r=this.progressCache;for(r.push({stamp:(new Date).getTime(),progress:t});r.length>20;)r.shift();if(1!==r.length){Ee.show(n.syncRemainBox);var o=[r[0],r[r.length-1]],i=o[0],a=o[1],s=a.progress-i.progress;if(0!==s){var l=s/(a.stamp-i.stamp),c=(1-a.progress)/l;n.syncRemain.textContent=Ee.formatDuration(c)}else n.syncRemain.textContent="> 1 day"}}}]),e}(),bt=function(){function e(t,n,r){var o=this;dt(this,e),this.page=Ee.idDescendants(t),this.form=t,this.pwCache=r,this.currentAsset=null,this.success=n,Et(t,this.page.submitUnlock,(function(){return o.submit()}))}var t;return pt(e,[{key:"setAsset",value:function(e){var t=this.page;this.currentAsset=e,t.uwAssetLogo.src=Ee.logoPath(e.symbol),t.uwAssetName.textContent=e.info.name,t.uwAppPass.value="",Ue.passwordIsCached()||this.pwCache&&this.pwCache.pw?Ee.hide(t.uwAppPassBox):Ee.show(t.uwAppPassBox)}},{key:"setError",value:function(e){this.page.unlockErr.textContent=e,Ee.show(this.page.unlockErr)}},{key:"showErrorOnly",value:function(e){this.setError(e),Ee.hide(this.page.uwAppPassBox),Ee.hide(this.page.submitUnlockDiv)}},{key:"submit",value:(t=lt((function*(){var e=this.page,t=e.uwAppPass.value||(this.pwCache?this.pwCache.pw:"");if(!t&&!Ue.passwordIsCached())return e.unlockErr.textContent=ce(c),void Ee.show(e.unlockErr);Ee.hide(this.page.unlockErr);var n={assetID:parseInt(this.currentAsset.id),pass:t};e.uwAppPass.value="";var r=ze().loading(this.form),o=yield Ke("/api/openwallet",n);r(),ze().checkResponse(o)?(this.pwCache&&(this.pwCache.pw=t),this.success()):this.setError(o.msg)})),function(){return t.apply(this,arguments)})}]),e}(),kt=function(){function e(t,n,r){var o=this;dt(this,e),this.form=t,this.success=n,this.pwCache=r,this.defaultTLSText="none selected";var i=this.page=Ee.parseTemplate(t);i.selectedCert.textContent=this.defaultTLSText,Ee.bind(i.certFile,"change",(function(){return o.onCertFileChange()})),Ee.bind(i.removeCert,"click",(function(){return o.clearCertFile()})),Ee.bind(i.addCert,"click",(function(){return i.certFile.click()})),Ee.bind(i.showCustom,"click",(function(){Ee.hide(i.showCustom),Ee.show(i.customBox,i.auth)})),this.knownExchanges=Array.from(i.knownXCs.querySelectorAll(".known-exchange"));var a,s=at(this.knownExchanges);try{var l=function(){var e=a.value;Ee.bind(e,"click",(function(){var t,n=e.dataset.host,a=at(o.knownExchanges);try{for(a.s();!(t=a.n()).done;)t.value.classList.remove("selected")}catch(e){a.e(e)}finally{a.f()}if(Ue.passwordIsCached()||r&&r.pw)return o.checkDEX(n);e.classList.add("selected"),i.appPW.focus(),i.addr.value=n}))};for(s.s();!(a=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}Et(t,i.submit,(function(){return o.checkDEX()})),this.refresh()}var t,n,r;return pt(e,[{key:"refresh",value:function(){var e=this.page;e.addr.value="",Ue.passwordIsCached()||this.pwCache&&this.pwCache.pw?Ee.hide(e.appPWBox,e.auth):Ee.show(e.appPWBox,e.auth),Ee.hide(e.customBox),Ee.show(e.showCustom);var t,n=at(this.knownExchanges);try{for(n.s();!(t=n.n()).done;)t.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}}},{key:"animate",value:(r=lt((function*(){var e=this.form;Ee.animate(550,(function(t){e.style.transform="scale(".concat(.9+.1*t,")"),e.style.opacity=Math.pow(t,4)}),"easeOut")})),function(){return r.apply(this,arguments)})},{key:"checkDEX",value:(n=lt((function*(e){var t=this.page;if(Ee.hide(t.err),""===(e=e||t.addr.value))return t.err.textContent="DEX address cannot be empty",void Ee.show(t.err);var n="";t.certFile.value&&(n=yield t.certFile.files[0].text());var r="";Ue.passwordIsCached()||(r=t.appPW.value||this.pwCache.pw);var o=ze().loading(this.form),i=yield Ke("/api/discoveracct",{addr:e,cert:n,pass:r});if(o(),ze().checkResponse(i,!0)){if(i.paid)return yield ze().fetchUser(),void ze().loadPage("markets");this.pwCache&&(this.pwCache.pw=r),this.success(i.xc,n)}else"certificate required"===i.msg?Ee.show(t.needCert):(t.err.textContent=i.msg,Ee.show(t.err))})),function(e){return n.apply(this,arguments)})},{key:"onCertFileChange",value:(t=lt((function*(){var e=this.page,t=e.certFile.files;t.length&&(e.selectedCert.textContent=t[0].name,Ee.show(e.removeCert),Ee.hide(e.addCert))})),function(){return t.apply(this,arguments)})},{key:"clearCertFile",value:function(){var e=this.page;e.certFile.value="",e.selectedCert.textContent=this.defaultTLSText,Ee.hide(e.removeCert),Ee.show(e.addCert)}}]),e}(),xt=function(){function e(t,n,r){var o=this;dt(this,e),this.success=n,this.form=t,this.pwCache=r;var i=this.page=Ee.parseTemplate(t);this.headerTxt=i.header.textContent,Et(t,i.submit,(function(){o.submit()}))}var t,n;return pt(e,[{key:"focus",value:function(){this.page.pw.focus()}},{key:"submit",value:(n=lt((function*(e){var t=this.page;Ee.hide(t.errMsg);var n=t.pw.value;t.pw.value="";var r=t.rememberPass.checked;if(""===n)return t.errMsg.textContent=ce(l),void Ee.show(t.errMsg);var o=ze().loading(this.form),i=yield Ke("/api/login",{pass:n,rememberPass:r});if(o(),!ze().checkResponse(i))return t.errMsg.textContent=i.msg,void Ee.show(t.errMsg);i.notes&&i.notes.reverse(),ze().setNotes(i.notes||[]),this.pwCache&&(this.pwCache.pw=n),this.success()})),function(e){return n.apply(this,arguments)})},{key:"animate",value:(t=lt((function*(){var e=this.form;Ee.animate(550,(function(t){e.style.transform="scale(".concat(.9+.1*t,")"),e.style.opacity=Math.pow(t,4)}),"easeOut")})),function(){return t.apply(this,arguments)})}]),e}(),Ct=300;function St(e,t){return At.apply(this,arguments)}function At(){return(At=lt((function*(e,t){var n=document.body.offsetWidth/2;yield Ee.animate(Ct,(function(t){e.style.right="".concat(t*n,"px")}),"easeInHard"),Ee.hide(e),e.style.right="0",t.style.right=-n,Ee.show(t),t.querySelector("input")&&t.querySelector("input").focus(),yield Ee.animate(Ct,(function(e){t.style.right="".concat(e*n-n,"px")}),"easeOutHard"),t.style.right="0"}))).apply(this,arguments)}function Et(e,t,n){var r=function(e){e.preventDefault&&e.preventDefault(),n(e)};Ee.bind(t,"click",r),Ee.bind(e,"submit",r)}function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ft(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Rt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ft(i,r,o,a,s,"next",e)}function s(e){Ft(i,r,o,a,s,"throw",e)}a(void 0)}))}}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dt(e,t){if(t&&("object"===Ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Pt(e){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(p,e);var t,n,r,o,i,a,s,c,u,h,d,f=(h=p,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Pt(h);if(d){var n=Pt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Dt(this,e)});function p(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=f.call(this)).body=e,t.pwCache={},t.currentDEX=null;var n=t.page=Ee.idDescendants(e);e.querySelectorAll(".form-closer").forEach((function(e){return Ee.hide(e)})),Et(n.appPWForm,n.appPWSubmit,(function(){return t.setAppPass()})),Ee.bind(n.showSeedRestore,"click",(function(){Ee.show(n.seedRestore),Ee.hide(n.showSeedRestore)})),t.loginForm=new xt(n.loginForm,Rt((function*(){yield ze().fetchUser(),t.dexAddrForm.refresh(),St(n.loginForm,n.dexAddrForm)})),t.pwCache),t.newWalletForm=new mt(n.newWalletForm,(function(e){return t.newWalletCreated(e)}),t.pwCache,(function(){return t.animateRegAsset(n.newWalletForm)})),t.dexAddrForm=new kt(n.dexAddrForm,function(){var e=Rt((function*(e,r){t.currentDEX=e,t.confirmRegisterForm.setExchange(e,r),t.walletWaitForm.setExchange(e),t.regAssetForm.setExchange(e),t.animateRegAsset(n.dexAddrForm)}));return function(t,n){return e.apply(this,arguments)}}(),t.pwCache),t.regAssetForm=new gt(n.regAssetForm,(function(e){t.confirmRegisterForm.setAsset(e);var r=ze().assets[e],o=r.wallet;if(o){var i=t.currentDEX.regFees[r.symbol];return o.synced&&o.balance.available>i.amount?void t.animateConfirmForm(n.regAssetForm):(t.walletWaitForm.setWallet(o),void St(n.regAssetForm,n.walletWait))}t.newWalletForm.setAsset(e),t.newWalletForm.loadDefaults(),St(n.regAssetForm,n.newWalletForm)})),t.walletWaitForm=new wt(n.walletWait,(function(){t.animateConfirmForm(n.walletWait)}),(function(){t.animateRegAsset(n.walletWait)})),t.confirmRegisterForm=new vt(n.confirmRegForm,(function(){t.registerDEXSuccess()}),(function(){t.animateRegAsset(n.confirmRegForm)}),t.pwCache);var r=n.forms.querySelector(":scope > form.selected");switch(r.classList.remove("selected"),r){case n.loginForm:t.loginForm.animate();break;case n.dexAddrForm:t.dexAddrForm.animate()}return Ee.show(r),ze().user.authed&&t.auth(),t.notifiers={walletstate:function(e){return t.walletWaitForm.reportWalletState(e.wallet)},balance:function(e){return t.walletWaitForm.reportBalance(e.balance,e.assetID)}},t}return t=p,(n=[{key:"unload",value:function(){delete this.pwCache.pw}},{key:"auth",value:(u=Rt((function*(){yield ze().fetchUser()})),function(){return u.apply(this,arguments)})},{key:"animateRegAsset",value:(c=Rt((function*(e){Ee.hide(e),this.regAssetForm.animate(),Ee.show(this.page.regAssetForm)})),function(e){return c.apply(this,arguments)})},{key:"animateConfirmForm",value:(s=Rt((function*(e){this.confirmRegisterForm.animate(),Ee.hide(e),Ee.show(this.page.confirmRegForm)})),function(e){return s.apply(this,arguments)})},{key:"setAppPass",value:(a=Rt((function*(){var e=this.page;Ee.hide(e.appPWErrMsg);var t=e.appPW.value,n=e.appPWAgain.value;if(""===t)return e.appPWErrMsg.textContent=ce(l),void Ee.show(e.appPWErrMsg);if(t!==n)return e.appPWErrMsg.textContent=ce(P),void Ee.show(e.appPWErrMsg);ze().setNotes([]),e.appPW.value="",e.appPWAgain.value="";var r=ze().loading(e.appPWForm),o=e.seedInput.value,i=e.rememberPass.checked,a=yield Ke("/api/init",{pass:t,seed:o,rememberPass:i});if(r(),!ze().checkResponse(a))return e.appPWErrMsg.textContent=a.msg,void Ee.show(e.appPWErrMsg);this.pwCache.pw=t,this.auth(),ze().updateMenuItemsDisplay(),this.newWalletForm.refresh(),this.dexAddrForm.refresh(),yield St(e.appPWForm,e.dexAddrForm)})),function(){return a.apply(this,arguments)})},{key:"getCertFile",value:(i=Rt((function*(){var e="";return this.dexAddrForm.page.certFile.value&&(e=yield this.dexAddrForm.page.certFile.files[0].text()),e})),function(){return i.apply(this,arguments)})},{key:"getDexAddr",value:function(){return this.page.dexAddr.value}},{key:"registerDEXSuccess",value:(o=Rt((function*(){yield ze().fetchUser(),ze().loadPage("markets")})),function(){return o.apply(this,arguments)})},{key:"newWalletCreated",value:(r=Rt((function*(e){this.regAssetForm.refresh();var t=yield ze().fetchUser(),n=this.page,r=t.assets[e],o=r.wallet,i=this.currentDEX.regFees[r.symbol].amount;o.synced&&o.balance.available>i?yield this.animateConfirmForm(n.newWalletForm):(this.walletWaitForm.setWallet(o),yield St(n.newWalletForm,n.walletWait))})),function(e){return r.apply(this,arguments)})}])&&It(t.prototype,n),p}(He);function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mt(e,t){return(Mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jt(e,t){if(t&&("object"===Bt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _t(e){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mt(e,t)}(l,e);var t,n,r,o,i,a,s=(i=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_t(i);if(a){var n=_t(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return jt(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this)).form=Ee.idel(e,"loginForm"),Ee.show(t.form),t.loginForm=new xt(t.form,(function(){t.loggedIn()})),t.loginForm.focus(),t}return t=l,(n=[{key:"loggedIn",value:(r=function*(e){yield ze().fetchUser(),ze().loadPage("markets")},o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Wt(i,n,o,a,s,"next",e)}function s(e){Wt(i,n,o,a,s,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})}])&&qt(t.prototype,n),l}(He);function Ut(e,t,n){return{subject:e,details:t,severity:n,stamp:(new Date).getTime()}}function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Yt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Xt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ht(i,r,o,a,s,"next",e)}function s(e){Ht(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Yt(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Yt(e,t){if(e){if("string"==typeof e)return Gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(e,t):void 0}}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zt(e,t){return(Zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $t(e,t){if(t&&("object"===zt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Jt(e)}function Jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(e){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tn=Ee.bind,nn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zt(e,t)}(A,e);var t,n,r,o,i,a,s,l,u,h,d,f,p,m,y,v,g,w,b,k,x,C,S=(x=A,C=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=en(x);if(C){var n=en(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $t(this,e)});function A(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,A),(t=S.call(this)).body=e;var n,r,o=t.page=Ee.idDescendants(e),i=function(e,t){return e.querySelector("[data-action=".concat(t,"]"))},a=t.rowInfos={},s=Qt(o.walletTable.querySelectorAll("tr"));try{for(s.s();!(r=s.n()).done;){var l=r.value,c=parseInt(l.dataset.assetID),u=a[c]={};n||(n=u),u.assetID=c,u.tr=l,u.symbol=l.dataset.symbol,u.name=l.dataset.name,u.stateIcons=new Fe(l),u.actions={connect:i(l,"connect"),unlock:i(l,"unlock"),withdraw:i(l,"withdraw"),deposit:i(l,"deposit"),create:i(l,"create"),rescan:i(l,"rescan"),lock:i(l,"lock"),settings:i(l,"settings")}}}catch(e){s.e(e)}finally{s.f()}o.marketCard.removeAttribute("id"),o.marketCard.remove(),o.oneMarket.removeAttribute("id"),o.oneMarket.remove(),t.displayed=null,t.animation=null,t.openAsset=null,t.walletAsset=null,t.reconfigAsset=null,t.withdrawAsset=null,t.newWalletForm=new mt(o.newWalletForm,(function(){t.createWalletSuccess()})),t.reconfigForm=new yt(o.reconfigInputs,!1),t.unlockForm=new bt(o.unlockWalletForm,(function(){t.openWalletSuccess()})),Et(o.withdrawForm,o.submitWithdraw,(function(){t.withdraw()})),Et(o.reconfigForm,o.submitReconfig,(function(){return t.reconfig()}));for(var h=function(){var e=f[d];tn(e.tr,"click",(function(){t.showMarkets(e.assetID)}))},d=0,f=Object.values(a);d<f.length;d++)h();o.rightBox.querySelectorAll(".form-closer").forEach((function(e){Ee.bind(e,"click",(function(){t.showMarkets(t.lastFormAsset)}))})),t.keyup=function(e){"Escape"===e.key&&t.showMarkets(t.lastFormAsset)},tn(document,"keyup",t.keyup),tn(o.downloadLogs,"click",Xt((function*(){t.downloadLogs()})));for(var p=function(){var e=Vt(y[m],2),n=e[0],r=e[1],o=parseInt(n),i=r.actions,a=function(e,t){e.stopPropagation(),t(o,r)};tn(i.connect,"click",(function(e){a(e,t.doConnect.bind(Jt(t)))})),tn(i.withdraw,"click",(function(e){a(e,t.showWithdraw.bind(Jt(t)))})),tn(i.deposit,"click",(function(e){a(e,t.showDeposit.bind(Jt(t)))})),tn(i.create,"click",(function(e){a(e,t.showNewWallet.bind(Jt(t)))})),tn(i.rescan,"click",(function(e){a(e,t.rescanWallet.bind(Jt(t)))})),tn(i.unlock,"click",(function(e){a(e,t.openWallet.bind(Jt(t)))})),tn(i.lock,"click",function(){var e=Xt((function*(e){a(e,t.lock.bind(Jt(t)))}));return function(t){return e.apply(this,arguments)}}()),tn(i.settings,"click",(function(e){a(e,t.showReconfig.bind(Jt(t)))}))},m=0,y=Object.entries(a);m<y.length;m++)p();return tn(o.newDepAddrBttn,"click",Xt((function*(){t.newDepositAddress()}))),tn(o.withdrawAvail,"click",(function(){var e=t.withdrawAsset;o.withdrawAmt.value=e.wallet.balance.available/e.info.unitinfo.conventional.conversionFactor})),tn(o.showChangePW,"click",(function(){t.changeWalletPW=!t.changeWalletPW,t.setPWSettingViz(t.changeWalletPW)})),tn(o.changeWalletTypeSelect,"change",(function(){t.changeWalletType()})),tn(o.showChangeType,"click",(function(){Ee.isHidden(o.changeWalletType)?(Ee.show(o.changeWalletType,o.changeTypeHideIcon),Ee.hide(o.changeTypeShowIcon),o.changeTypeMsg.textContent=ce(ee)):t.showReconfig(t.reconfigAsset)})),n?(t.showMarkets(n.assetID),t.notifiers={balance:function(e){t.handleBalanceNote(e)},walletstate:function(e){t.handleWalletStateNote(e)},walletconfig:function(e){t.handleWalletStateNote(e)}},t):$t(t)}return t=A,(n=[{key:"setPWSettingViz",value:function(e){if(e)return Ee.hide(this.page.showIcon),Ee.show(this.page.hideIcon,this.page.changePW),void(this.page.switchPWMsg.textContent=ce(B));Ee.hide(this.page.hideIcon,this.page.changePW),Ee.show(this.page.showIcon),this.page.switchPWMsg.textContent=ce(W)}},{key:"hideBox",value:(k=Xt((function*(){this.animation&&(yield this.animation),this.displayed&&Ee.hide(this.displayed)})),function(){return k.apply(this,arguments)})},{key:"showBox",value:(b=Xt((function*(e,t){e.style.opacity="0",Ee.show(e),t&&t.focus(),yield Ee.animate(300,(function(t){e.style.opacity="".concat(t)}),"easeOut"),e.style.opacity="1",this.displayed=e})),function(e,t){return b.apply(this,arguments)})},{key:"showMarkets",value:(w=Xt((function*(e){var t=this.page,n=t.marketsBox,r=t.marketsCard,o=this.rowInfos[e];yield this.hideBox(),Ee.empty(r),t.marketsFor.textContent=o.name,t.marketsForLogo.src=Ee.logoPath(ze().assets[e].symbol);for(var i=0,a=Object.entries(ze().user.exchanges);i<a.length;i++){for(var s=Vt(a[i],2),l=s[0],c=s[1],u=0,h=0,d=Object.values(c.markets);h<d.length;h++){var f=d[h];f.baseid!==e&&f.quoteid!==e||u++}if(0!==u){var p=t.marketCard.cloneNode(!0),m=Ee.parseTemplate(p);m.dexTitle.textContent=l,r.appendChild(p);for(var y=function(){var n=g[v];if(n.baseid!==e&&n.quoteid!==e)return"continue";var r=t.oneMarket.cloneNode(!0);r.querySelector("span").textContent=rn(n);var o=n.basesymbol;n.baseid===e&&(o=n.quotesymbol),r.querySelector("img").src=Ee.logoPath(o);var i={host:l,base:n.baseid,quote:n.quoteid};tn(r,"click",(function(){ze().loadPage("markets",i)})),m.markets.appendChild(r)},v=0,g=Object.values(c.markets);v<g.length;v++)y()}}this.animation=this.showBox(n)})),function(e){return w.apply(this,arguments)})},{key:"showNewWallet",value:(g=Xt((function*(e){var t=this.page.newWalletForm;yield this.hideBox(),this.walletAsset=this.lastFormAsset=e,this.newWalletForm.setAsset(e),this.animation=this.showBox(t),yield this.newWalletForm.loadDefaults()})),function(e){return g.apply(this,arguments)})},{key:"rescanWallet",value:(v=Xt((function*(e){var t=ze().loading(this.body),n=yield Ke("/api/rescanwallet",{assetID:e,force:!1});t(),ze().checkResponse(n)})),function(e){return v.apply(this,arguments)})},{key:"openWallet",value:(y=Xt((function*(e){if(Ue.passwordIsCached()){this.openAsset=e;var t={assetID:parseInt(e)},n=yield Ke("/api/openwallet",t);ze().checkResponse(n)?this.openWalletSuccess.bind(this)():this.showOpen(e,"Error opening wallet: ".concat(n.msg))}else this.showOpen(e)})),function(e){return y.apply(this,arguments)})},{key:"showOpen",value:(m=Xt((function*(e,t){var n=this.page;this.openAsset=this.lastFormAsset=e,yield this.hideBox(),this.unlockForm.setAsset(ze().assets[e]),t&&this.unlockForm.showErrorOnly(t),this.animation=this.showBox(n.unlockWalletForm,n.walletPass)})),function(e,t){return m.apply(this,arguments)})},{key:"showReconfig",value:(p=Xt((function*(e){var t=this.page;Ee.hide(t.changeWalletType,t.changeTypeHideIcon,t.reconfigErr,t.showChangeType,t.changeTypeHideIcon),Ee.hide(t.reconfigErr),this.reconfigAsset=this.lastFormAsset=e,this.changeWalletPW=!1,this.setPWSettingViz(this.changeWalletPW);var n=ze().assets[e],r=ze().currentWalletDefinition(e);if(n.info.availablewallets.length>1){Ee.empty(t.changeWalletTypeSelect),Ee.show(t.showChangeType,t.changeTypeShowIcon),t.changeTypeMsg.textContent=ce(J);var o,i=Qt(n.info.availablewallets);try{for(i.s();!(o=i.n()).done;){var a=o.value,s=document.createElement("option");a.type===r.type&&(s.selected="1"),s.value=s.textContent=a.type,t.changeWalletTypeSelect.appendChild(s)}}catch(e){i.e(e)}finally{i.f()}}else Ee.hide(t.showChangeType);0!=(4&ze().walletMap[e].traits)?Ee.show(t.downloadLogs):Ee.hide(t.downloadLogs),t.recfgAssetLogo.src=Ee.logoPath(n.symbol),t.recfgAssetName.textContent=n.info.name,yield this.hideBox(),this.animation=this.showBox(t.reconfigForm);var l=ze().loading(t.reconfigForm),c=yield Ke("/api/walletsettings",{assetID:e});if(l(),!ze().checkResponse(c,!0))return t.reconfigErr.textContent=c.msg,void Ee.show(t.reconfigErr);this.reconfigForm.update(r.configopts||[]),this.reconfigForm.setConfig(c.map),this.updateDisplayedReconfigFields(r)})),function(e){return p.apply(this,arguments)})},{key:"changeWalletType",value:function(){var e=this.page.changeWalletTypeSelect.value,t=ze().walletDefinition(this.reconfigAsset,e);this.reconfigForm.update(t.configopts||[]),this.updateDisplayedReconfigFields(t)}},{key:"updateDisplayedReconfigFields",value:function(e){e.seeded?(Ee.hide(this.page.showChangePW),this.changeWalletPW=!1,this.setPWSettingViz(!1)):Ee.show(this.page.showChangePW)}},{key:"showDeposit",value:(f=Xt((function*(e){var t=this.page;Ee.hide(t.depositErr);var n=t.deposit,r=ze().assets[e];t.depositLogo.src=Ee.logoPath(r.symbol);var o=ze().walletMap[e];this.depositAsset=this.lastFormAsset=e,o?(yield this.hideBox(),t.depositName.textContent=r.info.name,t.depositAddress.textContent=o.address,0!=(2&o.traits)?Ee.show(t.newDepAddrBttn):Ee.hide(t.newDepAddrBttn),this.animation=this.showBox(n)):ze().notify(Ut("Cannot retrieve deposit address.","No wallet found for ".concat(r.info.name),5))})),function(e){return f.apply(this,arguments)})},{key:"newDepositAddress",value:(d=Xt((function*(){var e=this.page;Ee.hide(e.depositErr);var t=ze().loading(e.deposit),n=yield Ke("/api/depositaddress",{assetID:this.depositAsset});if(t(),!ze().checkResponse(n,!0))return e.depositErr.textContent=n.msg,void Ee.show(e.depositErr);e.depositAddress.textContent=n.address})),function(){return d.apply(this,arguments)})},{key:"showWithdraw",value:(h=Xt((function*(e){var t=this.page,n=t.withdrawForm,r=this.withdrawAsset=ze().assets[e],o=ze().walletMap[e];o||ze().notify(Ut("Cannot withdraw.","No wallet found for ".concat(r.info.name),5)),yield this.hideBox(),t.withdrawAddr.value="",t.withdrawAmt.value="",t.withdrawPW.value="",t.withdrawAvail.textContent=Ee.formatFullPrecision(o.balance.available,r.info.unitinfo),t.withdrawLogo.src=Ee.logoPath(r.symbol),t.withdrawName.textContent=r.info.name,n.dataset.assetID=this.lastFormAsset=e,this.animation=this.showBox(n,t.walletPass)})),function(e){return h.apply(this,arguments)})},{key:"doConnect",value:(u=Xt((function*(e){var t=ze().loading(this.body),n=yield Ke("/api/connectwallet",{assetID:e});if(t(),ze().checkResponse(n)){var r=this.rowInfos[e];Ee.hide(r.actions.connect)}})),function(e){return u.apply(this,arguments)})},{key:"createWalletSuccess",value:(l=Xt((function*(){var e=this.rowInfos[this.walletAsset];this.showMarkets(e.assetID);var t=e.actions;Ee.hide(t.create),Ee.show(t.withdraw,t.deposit,t.settings),yield ze().fetchUser(),ze().walletMap[e.assetID].encrypted&&Ee.show(t.lock)})),function(){return l.apply(this,arguments)})},{key:"openWalletSuccess",value:(s=Xt((function*(){var e=this.rowInfos[this.openAsset],t=e.actions;Ee.show(t.withdraw,t.deposit),Ee.hide(t.unlock,t.connect),ze().walletMap[e.assetID].encrypted&&Ee.show(t.lock),this.showMarkets(this.openAsset)})),function(){return s.apply(this,arguments)})},{key:"withdraw",value:(a=Xt((function*(){var e=this.page;Ee.hide(e.withdrawErr);var t=parseInt(e.withdrawForm.dataset.assetID),n=ze().unitInfo(t).conventional.conversionFactor,r={assetID:t,address:e.withdrawAddr.value,value:parseInt(Math.round(e.withdrawAmt.value*n)),pw:e.withdrawPW.value},o=ze().loading(e.withdrawForm),i=yield Ke("/api/withdraw",r);if(o(),!ze().checkResponse(i,!0))return e.withdrawErr.textContent=i.msg,void Ee.show(e.withdrawErr);this.showMarkets(t)})),function(){return a.apply(this,arguments)})},{key:"reconfig",value:(i=Xt((function*(){var e=this.page;if(Ee.hide(e.reconfigErr),!e.appPW.value&&!Ue.passwordIsCached())return e.reconfigErr.textContent=ce(c),void Ee.show(e.reconfigErr);var t=ze().currentWalletDefinition(this.reconfigAsset).type;Ee.isHidden(e.changeWalletType)||(t=e.changeWalletTypeSelect.value);var n=ze().loading(e.reconfigForm),r={assetID:this.reconfigAsset,config:this.reconfigForm.map(),appPW:e.appPW.value,walletType:t};this.changeWalletPW&&(r.newWalletPW=e.newPW.value);var o=yield Ke("/api/reconfigurewallet",r);if(e.appPW.value="",e.newPW.value="",n(),!ze().checkResponse(o,!0))return e.reconfigErr.textContent=o.msg,void Ee.show(e.reconfigErr);this.showMarkets(this.reconfigAsset)})),function(){return i.apply(this,arguments)})},{key:"lock",value:(o=Xt((function*(e,t){var n=this.page,r=ze().loading(n.newWalletForm),o=yield Ke("/api/closewallet",{assetID:e});if(r(),ze().checkResponse(o)){var i=t.actions;Ee.hide(i.withdraw,i.lock,i.deposit),Ee.show(i.unlock)}})),function(e,t){return o.apply(this,arguments)})},{key:"downloadLogs",value:(r=Xt((function*(){var e=new URLSearchParams("");e.append("assetid","".concat(this.reconfigAsset));var t=new URL(window.location);t.search=e.toString(),t.pathname="/wallets/logfile",window.open(t.toString())})),function(){return r.apply(this,arguments)})},{key:"handleBalanceNote",value:function(e){this.page.walletTable.querySelector('[data-balance-target="'.concat(e.assetID,'"]')).textContent=Ee.formatFullPrecision(e.balance.available,ze().unitInfo(e.assetID))}},{key:"handleWalletStateNote",value:function(e){this.rowInfos[e.wallet.assetID].stateIcons.readWallet(e.wallet)}},{key:"unload",value:function(){Ee.unbind(document,"keyup",this.keyup)}}])&&Kt(t.prototype,n),A}(He);function rn(e){return"".concat(e.basesymbol.toUpperCase(),"-").concat(e.quotesymbol.toUpperCase())}function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function sn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){an(i,r,o,a,s,"next",e)}function s(e){an(i,r,o,a,s,"throw",e)}a(void 0)}))}}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cn(e,t){return(cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function un(e,t){if(t&&("object"===on(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hn(e){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cn(e,t)}(x,e);var t,n,r,o,i,a,s,l,u,h,d,f,p,m,y,v,g,w,b,k=(w=x,b=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hn(w);if(b){var n=hn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return un(this,e)});function x(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,x),(t=k.call(this)).body=e,t.currentDEX=null;var n=t.page=Ee.idDescendants(e);t.forms=n.forms.querySelectorAll(":scope > form"),Ee.bind(n.darkMode,"click",(function(){Ue.dark(n.darkMode.checked),n.darkMode.checked?document.body.classList.add("dark"):document.body.classList.remove("dark")})),Ee.bind(n.showPokes,"click",(function(){var e=n.showPokes.checked;Ue.setCookie("popups",e?"1":"0"),ze().showPopups=e})),n.commitHash.textContent=ze().commitHash.substring(0,7),Ee.bind(n.addADex,"click",(function(){t.dexAddrForm.refresh(),t.showForm(n.dexAddrForm)})),t.regAssetForm=new gt(n.regAssetForm,(function(e){t.confirmRegisterForm.setAsset(e);var r=ze().assets[e],o=r.wallet;if(o){var i=t.currentDEX.regFees[r.symbol];return o.synced&&o.balance.available>i.amount?void t.animateConfirmForm(n.regAssetForm):(t.walletWaitForm.setWallet(o),void St(n.regAssetForm,n.walletWait))}t.newWalletForm.setAsset(e),t.newWalletForm.loadDefaults(),t.currentForm=n.newWalletForm,St(n.regAssetForm,n.newWalletForm)})),t.confirmRegisterForm=new vt(n.confirmRegForm,(function(){t.registerDEXSuccess()}),(function(){t.animateRegAsset(n.confirmRegForm)}),t.pwCache),t.newWalletForm=new mt(n.newWalletForm,(function(e){return t.newWalletCreated(e)}),t.pwCache,(function(){return t.animateRegAsset(n.newWalletForm)})),t.walletWaitForm=new wt(n.walletWait,(function(){t.animateConfirmForm(n.walletWait)}),(function(){t.animateRegAsset(n.walletWait)})),t.dexAddrForm=new kt(n.dexAddrForm,function(){var e=sn((function*(e,r){t.currentDEX=e,t.confirmRegisterForm.setExchange(e,r),t.walletWaitForm.setExchange(e),t.regAssetForm.setExchange(e),t.animateRegAsset(n.dexAddrForm)}));return function(t,n){return e.apply(this,arguments)}}()),Et(n.authorizeAccountExportForm,n.authorizeExportAccountConfirm,(function(){return t.exportAccount()})),Et(n.disableAccountForm,n.disableAccountConfirm,(function(){return t.disableAccount()}));var r=n.exchanges;if(void 0!==ze().user.exchanges)for(var o=function(){var e=a[i],o=Ee.tmplElement(r,"exportAccount-".concat(e));Ee.bind(o,"click",(function(){return t.prepareAccountExport(e,n.authorizeAccountExportForm)}));var s=Ee.tmplElement(r,"disableAccount-".concat(e));Ee.bind(s,"click",(function(){return t.prepareAccountDisable(e,n.disableAccountForm)}))},i=0,a=Object.keys(ze().user.exchanges);i<a.length;i++)o();Ee.bind(n.importAccount,"click",(function(){return t.prepareAccountImport(n.authorizeAccountImportForm)})),Et(n.authorizeAccountImportForm,n.authorizeImportAccountConfirm,(function(){return t.importAccount()})),Ee.bind(n.changeAppPW,"click",(function(){return t.showForm(n.changeAppPWForm)})),Et(n.changeAppPWForm,n.submitNewPW,(function(){return t.changeAppPW()})),Ee.bind(n.accountFile,"change",(function(){return t.onAccountFileChange()})),Ee.bind(n.removeAccount,"click",(function(){return t.clearAccountFile()})),Ee.bind(n.addAccount,"click",(function(){return n.accountFile.click()})),Ee.bind(n.exportSeed,"click",(function(){return t.showForm(n.exportSeedAuth)})),Et(n.exportSeedAuth,n.exportSeedSubmit,(function(){return t.submitExportSeedReq()}));var s=function(){Ee.hide(n.forms),n.exportSeedPW.value="",n.seedDiv.textContent=""};return Ee.bind(n.forms,"mousedown",(function(e){Ee.mouseInElement(e,t.currentForm)||s()})),t.keyup=function(e){"Escape"===e.key&&s()},Ee.bind(document,"keyup",t.keyup),n.forms.querySelectorAll(".form-closer").forEach((function(e){Ee.bind(e,"click",(function(){s()}))})),t.notifiers={walletstate:function(e){return t.walletWaitForm.reportWalletState(e.wallet)},balance:function(e){return t.walletWaitForm.reportBalance(e.balance,e.assetID)}},t}return t=x,(n=[{key:"newWalletCreated",value:(g=sn((function*(e){var t=yield ze().fetchUser(),n=this.page,r=t.assets[e],o=r.wallet,i=this.currentDEX.regFees[r.symbol].amount;o.synced&&o.balance.available>i?yield this.animateConfirmForm(n.newWalletForm):(this.walletWaitForm.setWallet(o),this.currentForm=n.walletWait,yield St(n.newWalletForm,n.walletWait))})),function(e){return g.apply(this,arguments)})},{key:"prepareAccountExport",value:(v=sn((function*(e,t){var n=this.page;n.exportAccountHost.textContent=e,n.exportAccountErr.textContent="",Ue.passwordIsCached()?this.exportAccount():this.showForm(t)})),function(e,t){return v.apply(this,arguments)})},{key:"prepareAccountDisable",value:(y=sn((function*(e,t){var n=this.page;n.disableAccountHost.textContent=e,n.disableAccountErr.textContent="",this.showForm(t)})),function(e,t){return y.apply(this,arguments)})},{key:"exportAccount",value:(m=sn((function*(){var e=this.page,t=e.exportAccountAppPass.value,n=e.exportAccountHost.textContent;e.exportAccountAppPass.value="";var r={pw:t,host:n},o=ze().loading(this.body),i=yield Ke("/api/exportaccount",r);if(o(),!ze().checkResponse(i))return e.exportAccountErr.textContent=i.msg,void Ee.show(e.exportAccountErr);var a=JSON.parse(JSON.stringify(i.account)),s=document.createElement("a");s.setAttribute("download","dcrAccount-"+n+".json"),s.setAttribute("href","data:text/json,"+JSON.stringify(a,null,2)),s.click(),Ee.hide(e.forms)})),function(){return m.apply(this,arguments)})},{key:"disableAccount",value:(p=sn((function*(){var e=this.page,t=e.disableAccountAppPW.value,n=e.disableAccountHost.textContent;e.disableAccountAppPW.value="";var r={pw:t,host:n},o=ze().loading(this.body),i=yield Ke("/api/disableaccount",r);if(o(),!ze().checkResponse(i,!0))return e.disableAccountErr.textContent=i.msg,void Ee.show(e.disableAccountErr);Ee.hide(e.forms),window.location.reload()})),function(){return p.apply(this,arguments)})},{key:"onAccountFileChange",value:(f=sn((function*(){var e=this.page,t=e.accountFile.files;t.length&&(e.selectedAccount.textContent=t[0].name,Ee.show(e.removeAccount),Ee.hide(e.addAccount))})),function(){return f.apply(this,arguments)})},{key:"clearAccountFile",value:function(){var e=this.page;e.accountFile.value="",e.selectedAccount.textContent="none selected",Ee.hide(e.removeAccount),Ee.show(e.addAccount)}},{key:"prepareAccountImport",value:(d=sn((function*(e){this.page.importAccountErr.textContent="",this.showForm(e)})),function(e){return d.apply(this,arguments)})},{key:"importAccount",value:(h=sn((function*(){var e=this.page,t=e.importAccountAppPass.value;e.importAccountAppPass.value="";var n,r="";e.accountFile.value&&(r=yield e.accountFile.files[0].text());try{n=JSON.parse(r)}catch(t){return e.importAccountErr.textContent=t.message,void Ee.show(e.importAccountErr)}if(void 0===n)return e.importAccountErr.textContent=ce(L),void Ee.show(e.importAccountErr);var o={pw:t,account:n},i=ze().loading(this.body),a=yield Ke("/api/importaccount",o);if(i(),!ze().checkResponse(a))return e.importAccountErr.textContent=a.msg,void Ee.show(e.importAccountErr);var s=yield Ke("/api/login",{pass:t});if(!ze().checkResponse(s))return e.importAccountErr.textContent=s.msg,void Ee.show(e.importAccountErr);yield ze().fetchUser(),Ee.hide(e.forms),window.location.reload()})),function(){return h.apply(this,arguments)})},{key:"submitExportSeedReq",value:(u=sn((function*(){var e=this.page,t=e.exportSeedPW.value,n=ze().loading(this.body),r=yield Ke("/api/exportseed",{pass:t});if(n(),!ze().checkResponse(r))return e.exportAccountErr.textContent=r.msg,void Ee.show(e.exportSeedE);e.exportSeedPW.value="",e.seedDiv.textContent=r.seed,this.showForm(e.authorizeSeedDisplay)})),function(){return u.apply(this,arguments)})},{key:"showForm",value:(l=sn((function*(e){var t=this.page;this.currentForm=e,this.forms.forEach((function(e){return Ee.hide(e)})),e.style.right="10000px",Ee.show(t.forms,e);var n=(t.forms.offsetWidth+e.offsetWidth)/2;yield Ee.animate(300,(function(t){e.style.right="".concat((1-t)*n,"px")}),"easeOutHard"),e.style.right="0"})),function(e){return l.apply(this,arguments)})},{key:"clearCertFile",value:function(){var e=this.page;e.certFile.value="",e.selectedCert.textContent=this.defaultTLSText,Ee.hide(e.removeCert),Ee.show(e.addCert)}},{key:"getCertFile",value:(s=sn((function*(){var e="";return this.dexAddrForm.page.certFile.value&&(e=yield this.dexAddrForm.page.certFile.files[0].text()),e})),function(){return s.apply(this,arguments)})},{key:"getDexAddr",value:function(){return this.page.dexAddr.value}},{key:"registerDEXSuccess",value:(a=sn((function*(){var e=this.page;e.dexAddr.value="",this.clearCertFile(),Ee.hide(e.forms),yield ze().fetchUser(),window.location.reload()})),function(){return a.apply(this,arguments)})},{key:"changeAppPW",value:(i=sn((function*(){var e=this.page;Ee.hide(e.changePWErrMsg);var t=function(){e.appPW.value="",e.newAppPW.value="",e.confirmNewPW.value=""};if(!e.appPW.value||!e.newAppPW.value||!e.confirmNewPW.value)return e.changePWErrMsg.textContent=ce(c),Ee.show(e.changePWErrMsg),void t();if(e.newAppPW.value!==e.confirmNewPW.value)return e.changePWErrMsg.textContent=ce(P),Ee.show(e.changePWErrMsg),void t();var n=ze().loading(e.changeAppPW),r={appPW:e.appPW.value,newAppPW:e.newAppPW.value};t();var o=yield Ke("/api/changeapppass",r);if(n(),!ze().checkResponse(o,!0))return e.changePWErrMsg.textContent=o.msg,void Ee.show(e.changePWErrMsg);Ee.hide(e.forms)})),function(){return i.apply(this,arguments)})},{key:"unload",value:function(){Ee.unbind(document,"keyup",this.keyup)}},{key:"animateRegAsset",value:(o=sn((function*(e){Ee.hide(e);var t=this.page.regAssetForm;this.currentForm=t,this.regAssetForm.animate(),Ee.show(t)})),function(e){return o.apply(this,arguments)})},{key:"animateConfirmForm",value:(r=sn((function*(e){this.confirmRegisterForm.animate();var t=this.page.confirmRegForm;this.currentForm=t,Ee.hide(e),Ee.show(t)})),function(e){return r.apply(this,arguments)})}])&&ln(t.prototype,n),x}(He);function fn(e,t){if(e){if("string"==typeof e)return pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pn(e,t):void 0}}function pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yn=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t.base,this.baseSymbol=n,this.quote=t.quote,this.quoteSymbol=r,this.buys=t.book.buys||[],this.sells=t.book.sells||[]}var t,n;return t=e,(n=[{key:"add",value:function(e){var t=e.sell?this.sells:this.buys;t.splice(function(e,t,n){for(var r in e)if(e[r].rate<t===n)return r;return e.length}(t,e.rate,!e.sell),0,e)}},{key:"remove",value:function(e){this.removeFromSide(this.sells,e)||this.removeFromSide(this.buys,e)}},{key:"removeFromSide",value:function(e,t){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||fn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.findOrder(e,t),2),r=n[0],o=n[1];return!!r&&(e.splice(o,1),!0)}},{key:"findOrder",value:function(e,t){for(var n in e)if(e[n].token===t)return[e[n],n];return[null,-1]}},{key:"updateRemaining",value:function(e,t,n){this.updateRemainingSide(this.sells,e,t,n)||this.updateRemainingSide(this.buys,e,t,n)}},{key:"updateRemainingSide",value:function(e,t,n,r){var o=this.findOrder(e,t)[0];return!!o&&(o.qty=n,o.qtyAtomic=r,!0)}},{key:"setEpoch",value:function(e){var t=function(t){return void 0===t.epoch||0===t.epoch||t.epoch===e};this.sells=this.sells.filter(t),this.buys=this.buys.filter(t)}},{key:"empty",value:function(){return!this.sells.length&&!this.buys.length}},{key:"count",value:function(){return this.sells.length+this.buys.length}},{key:"bestGapOrder",value:function(e){var t,n=null,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=fn(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(!o.epoch)return o;n||(n=o)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"bestGapBuy",value:function(){return this.bestGapOrder(this.buys)}},{key:"bestGapSell",value:function(){return this.bestGapOrder(this.sells)}}])&&mn(t.prototype,n),e}();function vn(e){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=kn(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function wn(e){return function(e){if(Array.isArray(e))return xn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||kn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(e,t){if(e){if("string"==typeof e)return xn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xn(e,t):void 0}}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sn(e,t)}function Sn(e,t){return(Sn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function An(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=On(e);if(t){var o=On(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return En(this,n)}}function En(e,t){if(t&&("object"===vn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function On(e){return(On=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function In(e,t,n){return t&&Rn(e.prototype,t),n&&Rn(e,n),e}var Tn=Ee.bind,Dn=Ee.unbind,Pn=2*Math.PI,Ln=String.fromCharCode(59914),Bn=String.fromCharCode(59915),Wn={axisLabel:"#b1b1b1",gridBorder:"#3a3a3a",gridLines:"#2a2a2a",gapLine:"#6b6b6b",value:"#9a9a9a",zoom:"#5b5b5b",zoomHover:"#aaa",sellLine:"#ae3333",buyLine:"#05a35a",sellFill:"#591a1a",buyFill:"#02572f",crosshairs:"#888",legendFill:"black",legendText:"#d5d5d5"},qn={axisLabel:"#1b1b1b",gridBorder:"#3a3a3a",gridLines:"#dadada",gapLine:"#595959",value:"#4d4d4d",zoom:"#777",zoomHover:"#333",sellLine:"#99302b",buyLine:"#207a46",sellFill:"#bd5959",buyFill:"#4cad75",crosshairs:"#595959",legendFill:"#e6e6e6",legendText:"#1b1b1b"},Mn=function(){function e(t){var n=this;Fn(this,e),this.parent=t,this.theme=Ue.isDark()?Wn:qn,this.canvas=document.createElement("canvas"),this.visible=!0,t.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.setZoomBttns(),this.mousePos=null,Tn(this.canvas,"mousemove",(function(e){n.mousePos={x:e.clientX-n.rect.left,y:e.clientY-n.rect.y},n.draw()})),Tn(this.canvas,"mouseleave",(function(){n.mousePos=null,n.draw()})),this.wheelLimiter=null,this.wheeled=function(){n.wheelLimiter=setTimeout((function(){n.wheelLimiter=null}),100)},Tn(this.canvas,"wheel",(function(e){n.wheel(e)})),this.boundResizer=function(){n.resize(t.clientHeight)},Tn(window,"resize",this.boundResizer),Tn(this.canvas,"click",(function(e){n.click(e)}))}return In(e,[{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"draw",value:function(){this.render()}},{key:"setZoomBttns",value:function(){}},{key:"click",value:function(e){this.clicked(e)}},{key:"wheel",value:function(e){this.zoom(e.deltaY<0),e.preventDefault()}},{key:"resize",value:function(e){var t=this;this.canvas.width=this.parent.clientWidth,this.canvas.height=e-20;var n=new Nn(40,this.canvas.width,10,this.canvas.height-30),r=new Nn(40,this.canvas.width,this.canvas.height-30,this.canvas.height),o=new Nn(0,40,10,this.canvas.height-30);this.plotRegion=new Un(this.ctx,n),this.xRegion=new Un(this.ctx,r),this.yRegion=new Un(this.ctx,o),window.requestAnimationFrame((function(){t.rect=t.canvas.getBoundingClientRect(),t.resized()}))}},{key:"zoom",value:function(e){this.wheelLimiter||this.zoomed(e)}},{key:"hide",value:function(){this.visible=!1,Ee.hide(this.canvas)}},{key:"show",value:function(){this.visible=!0,Ee.show(this.canvas),this.resize(this.parent.clientHeight)}},{key:"unattach",value:function(){Dn(window,"resize",this.boundResizer)}},{key:"render",value:function(){console.error("child class must override render method")}},{key:"applyLabelStyle",value:function(){this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.font="12px 'sans', sans-serif",this.ctx.fillStyle=this.theme.axisLabel}},{key:"plotXLabels",value:function(e,t,n,r){var o=this,i=new Nn(t,n,0,1);this.xRegion.plot(i,(function(i,a){o.applyLabelStyle();var s=(n+t)/2,l=t,c=s;e.lbls.forEach((function(e){i.fillText(e.txt,a.x(e.val),a.y(.5)),s>=l&&s<e.val&&(c=(l+e.val)/2),l=e.val})),i.font="11px 'sans', sans-serif",2===r.length?(i.fillText(r[0],a.x(c),a.y(.63)),i.fillText(r[1],a.x(c),a.y(.23))):1===r.length&&i.fillText(r[0],a.x(c),a.y(.5))}),!0),this.plotRegion.plot(i,(function(t,n){t.lineWidth=1,t.strokeStyle=o.theme.gridLines,e.lbls.forEach((function(e){Xn(t,n.x(e.val),n.y(0),n.x(e.val),n.y(1))}))}),!0)}},{key:"plotYLabels",value:function(e,t,n,r,o){var i=this,a=new Nn(0,1,n,r);this.yRegion.plot(a,(function(e,n){i.applyLabelStyle();var a=r/2,s=0,l=a;t.lbls.forEach((function(t){e.fillText(t.txt,n.x(.5),n.y(t.val)),a>=s&&a<t.val&&(l=(s+t.val)/2),s=t.val})),e.fillText(o,n.x(.5),n.y(l))}),!0),e.plot(a,(function(e,n){e.lineWidth=1,e.strokeStyle=i.theme.gridLines,t.lbls.forEach((function(t){Xn(e,n.x(0),n.y(t.val),n.x(1),n.y(t.val))}))}),!0)}},{key:"doYLabels",value:function(e,t,n,r){var o=zn(this.ctx,e.height(),this.dataExtents.y.min,this.dataExtents.y.max,50,t,n,r),i=1.5*o.widest;return this.yRegion.extents.x.max=i,this.yRegion.extents.y.max=e.extents.y.max,this.plotRegion.extents.x.min=i,this.xRegion.extents.x.min=i,this.plotYLabels(e,o,this.dataExtents.y.min,this.dataExtents.y.max,n),o}},{key:"drawFrame",value:function(){var e=this;this.plotRegion.plot(new Nn(0,1,0,1),(function(t,n){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.beginPath(),n.dataCoords((function(){t.moveTo(0,0),t.lineTo(0,1),t.lineTo(1,1),t.lineTo(1,0),t.lineTo(0,0)})),t.stroke()}))}}]),e}(),jn=function(e){Cn(n,e);var t=An(n);function n(e,r,o){var i;return Fn(this,n),(i=t.call(this,e)).reporters=r,i.book=null,i.dataExtents=null,i.zoomLevel=o,i.lotSize=null,i.rateStep=null,i.lines=[],i.markers={buys:[],sells:[]},i.resize(e.clientHeight),i}return In(n,[{key:"setZoomBttns",value:function(){this.zoomInBttn=new Un(this.ctx,new Nn(0,0,0,0)),this.zoomOutBttn=new Un(this.ctx,new Nn(0,0,0,0))}},{key:"resized",value:function(){this.setZoomBttns(),this.book&&this.draw()}},{key:"zoomed",value:function(e){var t;this.zoomLevel&&this.book.buys&&this.book.sells&&(this.wheeled(),this.zoomLevel*=e?2/3:1.5,this.zoomLevel=(2,(t=this.zoomLevel)<.005?.005:t>2?2:t),this.draw(),this.reporters.zoom(this.zoomLevel))}},{key:"clicked",value:function(e){if(this.dataExtents){var t=e.clientX-this.rect.left,n=e.clientY-this.rect.y;if(this.zoomInBttn.contains(t,n))this.zoom(!0);else if(this.zoomOutBttn.contains(t,n))this.zoom(!1);else{var r=this.plotRegion.translator(this.dataExtents);this.reporters.click(r.unx(t))}}}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"set",value:function(e,t,n,r,o){this.book=e,this.lotSize=t/r.conventional.conversionFactor;var i=[o.conventional.conversionFactor,r.conventional.conversionFactor],a=i[0],s=i[1];if(this.rateStep=n/et*a/s,this.baseUnit=r.conventional.unit,this.quoteUnit=o.conventional.unit,!this.zoomLevel){var l=bn(this.gap(),2),c=l[0],u=l[1],h=Math.max(u/c*5,.05);this.zoomLevel=Math.min(h,2)}this.draw()}},{key:"render",value:function(){var e=this;if(this.book&&this.visible){this.clear();var t=this.ctx,n=this.mousePos,r=this.book.buys,o=this.book.sells,i=bn(this.gap(),2),a=i[0],s=i[1],l=this.zoomLevel*a/2,c=a+l,u=a-l,h=wn(this.markers.buys),d=wn(this.markers.sells);h.sort((function(e,t){return t.rate-e.rate})),d.sort((function(e,t){return e.rate-t.rate}));for(var f=[],p=[],m=[],y=[],v=[],g={buyBase:0,buyQuote:0,sellBase:0,sellQuote:0},w=0,b=0,k=0;k<r.length;k++){var x=r[k];if(b+=x.qty,x.rate>=u&&m.push([x.rate,b]),!x.epoch)for(w+=x.qty,p.push([x.rate,w]),g.buyBase+=x.qty,g.buyQuote+=x.qty*x.rate;h.length&&Gn(h[0].rate,x.rate);){var C=h.shift();f.push({rate:C.rate,qty:x.epoch?b:w,sell:x.sell,active:C.active})}}var S=p.length?Hn(p)[1]:0;p.push([u,S]);var A=m.length?Hn(m)[1]:0;m.push([u,A]),b=w=0;for(var E=0;E<o.length;E++){var O=o[E];if(b+=O.qty,O.rate<=c&&v.push([O.rate,b]),!O.epoch)for(w+=O.qty,y.push([O.rate,w]),g.sellBase+=O.qty,g.sellQuote+=O.qty*O.rate;d.length&&Gn(d[0].rate,O.rate);){var F=d.shift();f.push({rate:F.rate,qty:O.epoch?b:w,sell:O.sell,active:F.active})}}var R=y.length?Hn(y)[1]:0;y.push([c,R]);var I=v.length?Hn(v)[1]:0;v.push([c,I]);var T=this.xRegion.extents.y.min,D=(T+30)/T,P=(I&&A?Math.max(A,I):I||A||1)*D,L=new Nn(u,c,0,P);this.dataExtents=L,this.doYLabels(this.plotRegion,this.lotSize,this.baseUnit);var B,W=zn(t,this.plotRegion.width(),L.x.min,L.x.max,100,this.rateStep,"");this.plotXLabels(W,u,c,["".concat(this.quoteUnit,"/"),this.baseUnit]),this.drawFrame(),this.plotRegion.plot(L,(function(t,r){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.lineWidth=2.5,t.strokeStyle=e.theme.gapLine,Xn(t,r.x(a),r.y(0),r.x(a),r.y(.3*L.y.max)),t.font="30px 'demi-sans', sans-serif",t.textAlign="center",t.textBaseline="middle",t.fillStyle=e.theme.value;var o=.5*L.y.max;t.fillText(Yn(a),r.x(a),r.y(o)),t.font="12px 'sans', sans-serif",t.fillText("".concat((s/a*100).toFixed(2),"% spread"),r.x(a),r.y(o)+24),t.textAlign="center",t.textBaseline="middle";var i=e.plotRegion.extents.midX,l=r.y(.9*P),h=L.xRange/a*100,d="".concat(h.toFixed(1),"%"),m=t.measureText(d).width;t.font="13px 'sans', sans-serif",t.fillText(d,i,l+1);var v=i-m/2-10-20,g=l-10;e.zoomOutBttn.setExtents(v,v+20,g,g+20);var w=n&&e.zoomOutBttn.contains(n.x,n.y);e.zoomOutBttn.plot(new Nn(0,1,0,1),(function(t,n){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,w&&(t.fillStyle=e.theme.zoomHover,t.font="13px 'icomoon'"),t.fillText(Bn,e.zoomOutBttn.extents.midX,e.zoomOutBttn.extents.midY)})),v=i+m/2+10,e.zoomInBttn.setExtents(v,v+20,g,g+20),w=n&&e.zoomInBttn.contains(n.x,n.y),e.zoomInBttn.plot(new Nn(0,1,0,1),(function(t,n){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,w&&(t.fillStyle=e.theme.zoomHover,t.font="14px 'icomoon'"),t.fillText(Ln,e.zoomInBttn.extents.midX,e.zoomInBttn.extents.midY)}));var b,k=function(e,n){e>c||e<u||(t.save(),t.setLineDash([3,5]),t.lineWidth=1.5,t.strokeStyle=n,Xn(t,r.x(e),r.y(0),r.x(e),r.y(P)),t.restore())},x=gn(e.lines||[]);try{for(x.s();!(b=x.n()).done;){var C=b.value;k(C.rate,C.color)}}catch(e){x.e(e)}finally{x.f()}var S,A=.005*(c-u),E=[],O=gn(f||[]);try{for(O.s();!(S=O.n()).done;){var F=S.value,R=n&&Kn(F.rate,r.unx(n.x),A);R&&E.push(F.rate),t.save(),t.lineWidth=R||F.active?5:3,t.strokeStyle=F.sell?e.theme.sellLine:e.theme.buyLine,t.fillStyle=F.sell?e.theme.sellFill:e.theme.buyFill;var I=R||F.active?10:8;t.beginPath();var T={x:r.x(F.rate),y:r.y(F.qty)-8},D=T.y-Math.sqrt(3)*I/2;t.moveTo(T.x,T.y),t.lineTo(T.x-I/2,D),t.lineTo(T.x+I/2,D),t.closePath(),t.stroke(),t.fill(),t.restore()}}catch(e){O.e(e)}finally{O.f()}if(n&&e.plotRegion.contains(n.x,n.y)){var W=r.unx(n.x),q=y,M=function(e){return e>=W},j=e.theme.sellLine;W<a&&(q=p,M=function(e){return e<=W},j=e.theme.buyLine);for(var _=q[0],N=0;N<q.length;N++){var U=q[N];if(M(U[0]))break;_=U}k(W,e.theme.crosshairs),B={rate:W,depth:_[1],dotColor:j,hoverMarkers:E}}})),t.lineWidth=1.5,t.setLineDash([3,3]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(v),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(m),t.lineWidth=2.5,t.setLineDash([]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(y),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(p),B&&this.plotRegion.plot(L,(function(e,t){!function(e,t,n,r,o){e.fillStyle=r,e.beginPath(),e.arc(t,n,5,0,Pn),e.fill()}(e,t.x(B.rate),t.y(B.depth),B.dotColor)})),this.reporters.volume(g),this.reporters.mouse(B)}}},{key:"drawDepth",value:function(e){var t,n=e[0],r=n[1];this.plotRegion.plot(this.dataExtents,(function(o,i){i.dataCoords((function(){o.beginPath(),o.moveTo(n[0],n[1]);for(var i=0;i<e.length;i++)t=e[i][0],o.lineTo(t,r),r=e[i][1],o.lineTo(t,r)})),o.stroke(),i.dataCoords((function(){o.lineTo(t,0),o.lineTo(n[0],0)})),o.closePath(),o.globalAlpha=.25,o.fill()}))}},{key:"gap",value:function(){var e=[this.book.bestGapBuy(),this.book.bestGapSell()],t=e[0],n=e[1];return t?n?[(n.rate+t.rate)/2,n.rate-t.rate]:[t.rate,0]:n?[n.rate,0]:[1,0]}},{key:"setLines",value:function(e){this.lines=e}},{key:"setMarkers",value:function(e){this.markers=e}}]),n}(Mn),_n=function(e){Cn(n,e);var t=An(n);function n(e,r){var o;return Fn(this,n),(o=t.call(this,e)).reporters=r,o.data=null,o.dataExtents=null,o.zoomLevel=1,o.numToShow=100,o.resize(e.clientHeight),o}return In(n,[{key:"resized",value:function(){var e=this,t=this.plotRegion.extents,n=new Nn(t.x.min,t.x.max,t.y.min,t.y.min+.85*t.yRange);this.candleRegion=new Un(this.ctx,n);var r=new Nn(t.x.min,t.x.max,t.y.min+.85*t.yRange,t.y.max);this.volumeRegion=new Un(this.ctx,r),this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout((function(){return e.draw()}),100)}},{key:"clicked",value:function(e){}},{key:"zoomed",value:function(e){var t=this.zoomLevels.indexOf(this.numToShow);if(e){if(0===t)return;this.numToShow=this.zoomLevels[t-1]}else{if(this.zoomLevels.length<=t+1||this.numToShow>this.data.candles.length)return;this.numToShow=this.zoomLevels[t+1]}this.draw()}},{key:"render",value:function(){var e=this,t=this.data;if(t&&this.visible){var n=t.ms,r=this.mousePos,o=t.candles||[],i=Math.min(this.numToShow,o.length),a=o.slice(o.length-i);if(this.clear(),0!==i){var s,l=function(e){return Zn(e.endStamp,n)},c=function(e){return l(e)+n},u=function(e){return l(e)+.2*n},h=.6*n,d=a[0],f=a[i-1],p=[d.highRate,d.lowRate,d.matchVolume],m=p[0],y=p[1],v=p[2],g=gn(a);try{for(g.s();!(s=g.n()).done;){var w=s.value;w.highRate>m&&(m=w.highRate),w.lowRate<y&&(y=w.lowRate),w.matchVolume>v&&(v=w.matchVolume)}}catch(e){g.e(e)}finally{g.f()}var b=this.market.ratestep,k=new Nn(l(d),c(f),y,m);y===m&&(k.y.min-=b,k.y.max+=b),this.dataExtents=k;var x=this.rateConversionFactor;this.doYLabels(this.candleRegion,b,this.market.quotesymbol,(function(e){return Yn(e/x)})),this.candleRegion.extents.x.min=this.yRegion.extents.x.max,this.volumeRegion.extents.x.min=this.yRegion.extents.x.max;var C,S=function(e,t,n,r){var o=e[0],i=e[e.length-1],a=Zn(o.endStamp,t),s=Zn(i.endStamp,t)+t,l=s-a,c=Math.min(e.length,n/100),u=Zn(l/c,t);if(0===u)return console.error("zero tick",t,l,c);var h=a,d=(new Date).getTimezoneOffset(),f=function(e){return(e-=6e4*d)-e%864e5},p=f(a),m=0;f(o)===f(i)&&(p=0);var y,v=[];for(y=t<864e5?function(e,t){return f(t)!==p?"".concat(Vn[e.getMonth()]).concat(e.getDate()," ").concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0")):"".concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0"))}:function(e){var t=e.getFullYear();return t!==m?"".concat(Vn[e.getMonth()]).concat(e.getDate()," '").concat(String(t).slice(2,4)):"".concat(Vn[e.getMonth()]).concat(e.getDate())};h<=s;){var g=new Date(h);v.push({val:h,txt:y(g,h)}),p=f(h),m=g.getFullYear(),h+=u}return{lbls:v}}(a,n,this.plotRegion.width());if(this.plotXLabels(S,l(d),c(f),[]),this.drawFrame(),r&&(this.plotRegion.plot(new Nn(k.x.min,k.x.max,0,1),(function(t,o){var i,s=Zn(o.unx(r.x),n),c=gn(a);try{for(c.s();!(i=c.n()).done;){var u=i.value;if(l(u)===s){C=u,t.fillStyle=e.theme.gridLines,t.fillRect(o.x(l(u)),o.y(0),o.w(n),o.h(1));break}}}catch(e){c.e(e)}finally{c.f()}})),C)){var A=this.xRegion.extents.y;this.xRegion.plot(new Nn(k.x.min,k.x.max,A.min,A.max),(function(t,n){e.applyLabelStyle();var r="".concat(new Date(l(C)).toLocaleString()," - ").concat(new Date(c(C)).toLocaleString()),o=t.measureText(r).width+50,i=n.x((l(C)+c(C))/2),a=i-o/2,s=e.xRegion.extents.x;a<s.min?a=s.min:a+o>s.max&&(a=s.max-o),i=a+o/2;var u=A.min+(e.xRegion.height()-16)/2;t.fillStyle=e.theme.legendFill,t.strokeStyle=e.theme.gridBorder;var h=[a-25,u-2,o+50,20];t.fillRect.apply(t,h),t.strokeRect.apply(t,h),e.applyLabelStyle(),t.fillText(r,i,e.xRegion.extents.midY,o)}))}var E=new Nn(l(d),c(f),0,v);this.volumeRegion.plot(E,(function(t,n){t.fillStyle=e.theme.gridBorder;var r,o=gn(a);try{for(o.s();!(r=o.n()).done;){var i=r.value;t.fillRect(n.x(u(i)),n.y(0),n.w(h),n.h(i.matchVolume))}}catch(e){o.e(e)}finally{o.f()}})),this.candleRegion.plot(k,(function(t,n){t.lineWidth=1;var r,o=gn(a);try{for(o.s();!(r=o.n()).done;){var i=r.value,s=i.startRate>i.endRate,l=[n.x(u(i)),n.y(i.startRate),n.w(h),n.h(i.endRate-i.startRate)],c=l[0],d=l[1],f=l[2],p=l[3],m=[n.y(i.highRate),n.y(i.lowRate),f/2+c],y=m[0],v=m[1],g=m[2];t.strokeStyle=s?e.theme.sellLine:e.theme.buyLine,t.fillStyle=s?e.theme.sellFill:e.theme.buyFill,t.beginPath(),t.moveTo(g,y),t.lineTo(g,v),t.stroke(),t.fillRect(c,d,f,p),t.strokeRect(c,d,f,p)}}catch(e){o.e(e)}finally{o.f()}})),this.reporters.mouse(C)}}}},{key:"setCandles",value:function(e,t,n,r){if(this.data=e,e.candles){this.market=t;var o=[r.conventional.conversionFactor,n.conventional.conversionFactor],i=o[0],a=o[1];this.rateConversionFactor=et*a/i;var s=25;this.zoomLevels=[];for(var l=Math.max(e.candles.length,1e3);s<l;)this.zoomLevels.push(s),s*=2;this.numToShow=100,this.draw()}}}]),n}(Mn),Nn=function(){function e(t,n,r,o){Fn(this,e),this.setExtents(t,n,r,o)}return In(e,[{key:"setExtents",value:function(e,t,n,r){this.x={min:e,max:t},this.y={min:n,max:r}}},{key:"xRange",get:function(){return this.x.max-this.x.min}},{key:"midX",get:function(){return(this.x.max+this.x.min)/2}},{key:"yRange",get:function(){return this.y.max-this.y.min}},{key:"midY",get:function(){return(this.y.max+this.y.min)/2}}]),e}(),Un=function(){function e(t,n){Fn(this,e),this.context=t,this.extents=n}return In(e,[{key:"setExtents",value:function(e,t,n,r){this.extents.setExtents(e,t,n,r)}},{key:"width",value:function(){return this.extents.xRange}},{key:"height",value:function(){return this.extents.yRange}},{key:"contains",value:function(e,t){var n=this.extents;return e<n.x.max&&e>n.x.min&&t<n.y.max&&t>n.y.min}},{key:"translator",value:function(e){var t=this.extents,n=e.x.min,r=e.y.min,o=e.yRange,i=e.xRange,a=t.x.min,s=t.x.max-a,l=t.y.max,c=l-t.y.min,u=s/i,h=c/o;return{x:function(e){return(e-n)*u+a},y:function(e){return l-(e-r)*h},unx:function(e){return(e-a)/u+n},uny:function(e){return r-(e-l)/h},w:function(e){return e/i*s},h:function(e){return-e/o*c}}}},{key:"clear",value:function(){var e=this.extents;this.ctx.clearRect(e.x.min,e.y.min,e.xRange,e.yRange)}},{key:"plot",value:function(e,t,n){var r=this.context,o=this.extents;r.save(),n||(r.beginPath(),r.rect(o.x.min,o.y.min,o.xRange,o.yRange),r.clip());var i=this.translator(e),a=e.yRange,s=o.xRange/e.xRange,l=o.yRange/a,c=e.x.min,u=e.y.min,h=o.x.min+c-c*s,d=-o.y.min-(a-u)*l;i.dataCoords=function(e){r.save(),r.transform(1,0,0,-1,-c,u),r.transform(s,0,0,l,h,d),e(),r.restore()},t(this.context,i),r.restore()}}]),e}();function zn(e,t,n,r,o,i,a,s){s=s||Yn;for(var l=(r-n)/(t/o),c=l+i-l%i,u=n+c-n%c,h=Math.max(Math.abs(r),Math.abs(n)),d=Math.round(Math.log10(h/c))+2,f=[],p=0;u<r;){var m=s(u=Number(u.toPrecision(d)));p=Math.max(p,e.measureText(m).width),f.push({val:u,txt:m}),u+=c}var y=e.measureText(a).width;return y>p&&(p=y),{widest:p,lbls:f}}var Vn=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function Hn(e){return e[e.length-1]}function Xn(e,t,n,r,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(r,o),i||e.stroke()}var Qn={minimumSignificantDigits:4,maximumSignificantDigits:5};function Yn(e){return e.toLocaleString("en-us",Qn)}function Gn(e,t){return Kn(e,t,1e-8)}function Kn(e,t,n){return Math.abs(e-t)<Math.abs(n)}function Zn(e,t){return e-e%t}function $n(e,t){if(e){if("string"==typeof e)return Jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jn(e,t):void 0}}function Jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tr(e,t,n){if(e||!t.error){if(void 0!==n[e])for(var r=0;r<n[e].length;r++)n[e][r](t)}else{var o=t.error;console.error("websocket error (code ".concat(o.code,"): ").concat(o.message))}}var nr=0;const rr=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uri=void 0,this.connection=void 0,this.handlers={},this.queue=[],this.maxQlength=5}var t,n;return t=e,(n=[{key:"registerRoute",value:function(e,t){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push(t)}},{key:"deregisterRoute",value:function(e){this.handlers[e]=[]}},{key:"request",value:function(e,t){if(this.connection&&this.connection.readyState===window.WebSocket.OPEN){nr++;var n=JSON.stringify({route:e,type:1,id:nr,payload:t});window.log("ws","sending",n),this.connection.send(n)}else{for(;this.queue.length>this.maxQlength-1;)this.queue.shift();this.queue.push([e,t])}}},{key:"close",value:function(e){window.log("ws","close, reason:",e,this.handlers),this.handlers={},this.connection.close()}},{key:"connect",value:function(e,t){var n=this;this.uri=e,this.reloader=t;var r=0;!function o(){window.log("ws","connecting to ".concat(e));var i=n.connection=new window.WebSocket(e),a=setTimeout((function(){i.close()}),500);i.onmessage=function(e){var t=JSON.parse(e.data);tr(t.route,t.payload,n.handlers)},i.onclose=function(e){window.log("ws","onclose"),clearTimeout(a),i=n.connection=null,tr("close",null,n.handlers),r++;var t=Math.min(Math.pow(1.25,r),10);console.error("websocket disconnected (".concat(e.code,"), trying again in ").concat(t.toFixed(1)," seconds")),setTimeout((function(){o()}),1e3*t)},i.onopen=function(){window.log("ws","onopen"),clearTimeout(a),r>0&&(r=0,t()),tr("open",null,n.handlers);var e=n.queue;n.queue=[];var o,i,s,l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=$n(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e);try{for(l.s();!(o=l.n()).done;){var c=(i=o.value,s=2,function(e){if(Array.isArray(e))return e}(i)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(i,s)||$n(i,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],h=c[1];n.request(u,h)}}catch(e){l.e(e)}finally{l.f()}},i.onerror=function(e){window.log("ws","onerror:",e),tr("error",e,n.handlers)}}()}}])&&er(t.prototype,n),e}());function or(e){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ir(e){return function(e){if(Array.isArray(e))return dr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||hr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lr(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function cr(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){lr(i,r,o,a,s,"next",e)}function s(e){lr(i,r,o,a,s,"throw",e)}a(void 0)}))}}function ur(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=hr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function hr(e,t){if(e){if("string"==typeof e)return dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dr(e,t):void 0}}function dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mr(e,t,n){return t&&pr(e.prototype,t),n&&pr(e,n),e}function yr(e,t){return(yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vr(e,t){if(t&&("object"===or(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gr(e){return(gr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wr=Ee.bind,br="book",kr="book_order",xr="unbook_order",Cr="epoch_order",Sr="candles",Ar="candle_update",Er="selectedMarket",Or="chartRatio",Fr="depthZoom",Rr="depth_chart",Ir="candle_chart",Tr=document.createElement("span");Tr.classList.add("ico-check");var Dr=new Intl.NumberFormat(document.documentElement.lang,{minimumFractionDigits:1,maximumFractionDigits:2}),Pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yr(e,t)}(p,e);var t,n,r,o,i,a,s,l,c,d,f=(c=p,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gr(c);if(d){var n=gr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vr(this,e)});function p(e,t){var n;fr(this,p);var r=(n=f.call(this)).page=Ee.idDescendants(e);n.main=e,n.loaded=ze().loading(n.main.parentElement),n.maxLoaded=null,n.maxOrderUpdateCounter=0,n.market=null,n.registrationStatus={},n.currentForm=null,n.openAsset=null,n.openFunc=null,n.currentCreate=null,n.preorderTimer=null,n.book=null,n.cancelData=null,n.metaOrders={},n.depthLines={hover:[],input:[]},n.activeMarkerRate=null,n.hovers=[],n.ordersSortKey="stamp",n.ordersSortDirection=1,n.ogTitle=document.title;var o={click:function(e){n.reportDepthClick(e)},volume:function(e){n.reportDepthVolume(e)},mouse:function(e){n.reportDepthMouse(e)},zoom:function(e){n.reportDepthZoom(e)}};n.depthChart=new jn(r.marketChart,o,Ue.fetch(Fr));var i={mouse:function(e){n.reportMouseCandle(e)}};n.candleChart=new _n(r.marketChart,i),n.candleChart.hide(),n.currentChart=Rr,n.candleDur="";var a=n.balanceWgt=new qr(r.balanceTable),s=a.base.stateIcons.icons,l=a.quote.stateIcons.icons;wr(a.base.connect,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),wr(a.quote.connect,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),wr(a.base.expired,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),wr(a.quote.expired,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),wr(s.sleeping,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),wr(l.sleeping,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),wr(s.locked,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),wr(l.locked,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),wr(a.base.newWalletBttn,"click",(function(){n.showCreate(n.market.base)})),wr(a.quote.newWalletBttn,"click",(function(){n.showCreate(n.market.quote)})),Ee.cleanTemplates(r.rowTemplate,r.liveTemplate,r.durBttnTemplate),n.marketList=new Lr(r.marketList);var c,u=ur(n.marketList.xcSections);try{var h=function(){var e,t=c.value,r=ur(t.marketRows);try{var o=function(){var r=e.value;wr(r.node,"click",(function(){n.setMarket(t.host,r.mkt.baseid,r.mkt.quoteid)}))};for(r.s();!(e=r.n()).done;)o()}catch(e){r.e(e)}finally{r.f()}};for(u.s();!(c=u.n()).done;)h()}catch(e){u.e(e)}finally{u.f()}n.quoteUnits=e.querySelectorAll("[data-unit=quote]"),n.baseUnits=e.querySelectorAll("[data-unit=base]"),wr(r.buyBttn,"click",(function(){Nr(r.sellBttn,r.buyBttn),r.submitBttn.classList.remove("sellred"),r.submitBttn.classList.add("buygreen"),r.maxLbl.textContent=ce(w),n.setOrderBttnText(),n.setOrderVisibility(),n.drawChartLines()})),wr(r.sellBttn,"click",(function(){Nr(r.buyBttn,r.sellBttn),r.submitBttn.classList.add("sellred"),r.submitBttn.classList.remove("buygreen"),r.maxLbl.textContent=ce(b),n.setOrderBttnText(),n.setOrderVisibility(),n.drawChartLines()})),wr(r.limitBttn,"click",(function(){Nr(r.marketBttn,r.limitBttn),n.setOrderVisibility(),r.rateField.value&&(n.depthLines.input=[{rate:r.rateField.value,color:n.isSell()?n.depthChart.theme.sellLine:n.depthChart.theme.buyLine}],n.drawChartLines())})),wr(r.marketBttn,"click",(function(){Nr(r.limitBttn,r.marketBttn),n.setOrderVisibility(),n.setMarketBuyOrderEstimate(),n.depthLines.input=[],n.drawChartLines()})),wr(r.maxOrd,"click",(function(){n.isSell()?r.lotField.value=n.market.maxSell.swap.lots:r.lotField.value=n.market.maxBuys[n.adjustedRate()].swap.lots,n.lotChanged()})),wr(r.depthBttn,"click",(function(){n.depthChartSelected()})),wr(r.candlestickBttn,"click",(function(){n.candleChartSelected()})),Ee.disableMouseWheel(r.rateField,r.lotField,r.qtyField,r.mktBuyField),rr.registerRoute(br,(function(e){n.handleBookRoute(e)})),rr.registerRoute(kr,(function(e){n.handleBookOrderRoute(e)})),rr.registerRoute(xr,(function(e){n.handleUnbookOrderRoute(e)})),rr.registerRoute("update_remaining",(function(e){n.handleUpdateRemainingRoute(e)})),rr.registerRoute(Cr,(function(e){n.handleEpochOrderRoute(e)})),rr.registerRoute(Ar,(function(e){n.handleCandleUpdateRoute(e)})),rr.registerRoute(Sr,(function(e){n.handleCandlesRoute(e)})),n.unlockForm=new bt(r.unlockWalletForm,cr((function*(){n.openFunc()}))),n.newWalletForm=new mt(r.newWalletForm,cr((function*(){n.createWallet()}))),Et(r.orderForm,r.submitBttn,cr((function*(){n.stepSubmit()}))),Et(r.verifyForm,r.vSubmit,cr((function*(){n.submitOrder()}))),Et(r.cancelForm,r.cancelSubmit,cr((function*(){n.submitCancel()}))),r.liveTable.querySelectorAll("[data-ordercol]").forEach((function(e){return wr(e,"click",(function(){return d(e.dataset.ordercol)}))}));var d=function(e){m(),n.ordersSortKey===e?n.ordersSortDirection*=-1:(n.ordersSortKey=e,n.ordersSortDirection=1),n.refreshActiveOrders(),y()},m=function(){r.liveTable.querySelectorAll("[data-ordercol]").forEach((function(e){return e.classList.remove("sorted-asc","sorted-dsc")}))},y=function(){var e=n.ordersSortKey,t=1===n.ordersSortDirection?"sorted-asc":"sorted-dsc";r.liveTable.querySelector("[data-ordercol=".concat(e,"]")).classList.add(t)};y();var v=function(){Ee.hide(r.forms),r.vPass.value="",r.cancelPass.value=""};wr(r.forms,"mousedown",(function(e){Ee.mouseInElement(e,n.currentForm)||v()})),n.keyup=function(e){"Escape"===e.key&&v()},wr(document,"keyup",n.keyup),r.forms.querySelectorAll(".form-closer").forEach((function(e){Ee.bind(e,"click",(function(){v()}))})),wr(r.lotField,"change",(function(){n.lotChanged()})),wr(r.lotField,"keyup",(function(){n.lotChanged()})),wr(r.qtyField,"change",(function(){n.quantityChanged(!0)})),wr(r.qtyField,"keyup",(function(){n.quantityChanged(!1)})),wr(r.mktBuyField,"change",(function(){n.marketBuyChanged()})),wr(r.mktBuyField,"keyup",(function(){n.marketBuyChanged()})),wr(r.rateField,"change",(function(){n.rateFieldChanged()})),wr(r.rateField,"keyup",(function(){n.previewQuoteAmt(!0)})),wr(r.marketSearch,"change",(function(){n.filterMarkets()})),wr(r.marketSearch,"keyup",(function(){n.filterMarkets()}));var g=function(){n.depthLines.hover=[],n.drawChartLines()};wr(r.buyRows,"mouseleave",g),wr(r.sellRows,"mouseleave",g),wr(r.liveList,"mouseleave",(function(){n.activeMarkerRate=null,n.setDepthMarkers()}));var k,x=function(e){e>.7?e=.7:e<.25&&(e=.25);var t=e*(n.main.clientHeight-ze().header.offsetHeight);r.marketChart.style.height="".concat(t,"px"),n.depthChart.resize(t),n.candleChart.resize(t)},C=Ue.fetch(Or);return C&&x(C),wr(r.chartResizer,"mousedown",(function(e){if(0===e.button){var t;e.preventDefault();var n=function(e){e.preventDefault();var n=r.rightSide.getBoundingClientRect(),o=n.bottom-n.top;t=(e.pageY-n.top)/o,x(t)};wr(document,"mousemove",n),wr(document,"mouseup",(function(){t&&Ue.store(Or,t),Ee.unbind(document,"mousemove",n)}))}})),n.notifiers={order:function(e){n.handleOrderNote(e)},epoch:function(e){n.handleEpochNote(e)},conn:function(e){n.handleConnNote(e)},balance:function(e){n.handleBalanceNote(e)},feepayment:function(e){n.handleFeePayment(e)},walletstate:function(e){n.handleWalletStateNote(e)},spots:function(e){n.handlePriceUpdate(e)}},(k=t&&t.host&&void 0!==t.base&&void 0!==t.quote?Mr(t.host,parseInt(t.base),parseInt(t.quote)):Ue.fetch(Er))&&n.marketList.exists(k.host,k.base,k.quote)||(k=n.marketList.first()),n.setMarket(k.host,k.base,k.quote),n.secondTicker=setInterval((function(){for(var e=0,t=Object.values(n.metaOrders);e<t.length;e++){var r=t[e];Ee.tmplElement(r.row,"age").textContent=Ee.timeSince(r.order.stamp)}}),1e3),n.setRegistrationStatusVisibility(),n.setBalanceVisibility(),n}return mr(p,[{key:"isSell",value:function(){return this.page.sellBttn.classList.contains("selected")}},{key:"isLimit",value:function(){return this.page.limitBttn.classList.contains("selected")}},{key:"hasFeePending",value:function(){return!!this.market.dex.pendingFee}},{key:"assetsAreSupported",value:function(){var e=[this.market.base,this.market.quote];return e[0]&&e[1]}},{key:"setOrderVisibility",value:function(){var e=this.page;this.isLimit()?(Ee.show(e.priceBox,e.tifBox,e.qtyBox,e.maxBox),Ee.hide(e.mktBuyBox),this.previewQuoteAmt(!0)):(Ee.hide(e.tifBox,e.maxBox,e.priceBox),this.isSell()?(Ee.hide(e.mktBuyBox),Ee.show(e.qtyBox),this.previewQuoteAmt(!0)):(Ee.show(e.mktBuyBox),Ee.hide(e.qtyBox),this.previewQuoteAmt(!1)))}},{key:"resolveOrderFormVisibility",value:function(){var e=this.page;Ee.hide(e.orderForm);var t=!this.hasFeePending(),n=this.assetsAreSupported(),r=this.market,o=r.base,i=r.quote,a=o&&ze().assets[o.id].wallet&&i&&ze().assets[i.id].wallet;t&&n&&a&&Ee.show(e.orderForm)}},{key:"setLoaderMsgVisibility",value:function(){var e=this.page,t=this.market,n=t.base,r=t.quote;if(this.assetsAreSupported())Ee.hide(e.loaderMsg);else{var o=!n&&this.market.baseCfg.symbol||!r&&this.market.quoteCfg.symbol;e.loaderMsg.textContent=ce(k,{asset:o.toUpperCase()}),Ee.show(e.loaderMsg)}}},{key:"setRegistrationStatusView",value:function(e,t,n){var r=this.page;r.regStatusTitle.textContent=e,r.regStatusConfsDisplay.textContent=t,r.registrationStatus.classList.remove("completed","error","waiting"),r.registrationStatus.classList.add(n)}},{key:"updateRegistrationStatusView",value:function(){var e=this.page,t=this.market.dex;e.regStatusDex.textContent=t.host;var n=t.pendingFee;if(n){var r=t.regFees[n.symbol].confs;e.confReq.textContent=r;var o="".concat(n.confs," / ").concat(r);this.setRegistrationStatusView(ce(H),o,"waiting")}else this.setRegistrationStatusView(ce(Q),"","completed")}},{key:"setRegistrationStatusVisibility",value:function(){var e=this,t=this.page,n=this.market.dex;if(n.connected)if(this.updateRegistrationStatusView(),n.pendingFee)Ee.show(t.registrationStatus);else{var r=function(){Ee.hide(t.registrationStatus),e.resolveOrderFormVisibility()};if(Ee.isHidden(t.orderForm))return void setTimeout(r,5e3);r()}}},{key:"setOrderBttnText",value:function(){this.isSell()?this.page.submitBttn.textContent=ce(h,{asset:this.market.base.symbol.toUpperCase()}):this.page.submitBttn.textContent=ce(u,{asset:this.market.base.symbol.toUpperCase()})}},{key:"setCandleDurBttns",value:function(){var e=this,t=this.page,n=this.market;Ee.empty(t.durBttnBox);var r,o=ur(n.dex.candleDurs);try{var i=function(){var n=r.value,o=t.durBttnTemplate.cloneNode(!0);o.textContent=n,Ee.bind(o,"click",(function(){return e.candleDurationSelected(n)})),t.durBttnBox.appendChild(o)};for(o.s();!(r=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}}},{key:"setMarket",value:(l=cr((function*(e,t,n){var r=ze().user.exchanges[e],o=this.page;if(!r.connected)return this.market={dex:r},o.chartErrMsg.textContent=ce(x),Ee.show(o.chartErrMsg),this.loaded(),this.main.style.opacity=1,void Ee.hide(o.marketLoader);var i=r.assets[t],a=r.assets[n],s=[ze().unitInfo(t,r),ze().unitInfo(n,r)],l=s[0],c=s[1],u=et/l.conventional.conversionFactor*c.conventional.conversionFactor;Ee.hide(o.maxOrd,o.chartErrMsg),this.preorderTimer&&(window.clearTimeout(this.preorderTimer),this.preorderTimer=null);var h=jr(i.symbol,a.symbol);this.market={dex:r,sid:h,cfg:r.markets[h],base:ze().assets[t],quote:ze().assets[n],baseUnitInfo:l,quoteUnitInfo:c,maxSell:null,maxBuys:{},candleCaches:{},baseCfg:i,quoteCfg:a,rateConversionFactor:u},Ee.show(o.marketLoader),r.candleDurs&&0!==r.candleDurs.length||(this.currentChart=Rr),this.currentChart===Rr?rr.request("loadmarket",Mr(e,t,n)):(-1===r.candleDurs.indexOf(this.candleDur)&&(this.candleDur=r.candleDurs[0]),this.loadCandles()),this.setLoaderMsgVisibility(),this.setRegistrationStatusVisibility(),this.resolveOrderFormVisibility(),this.setOrderBttnText(),this.setCandleDurBttns()})),function(e,t,n){return l.apply(this,arguments)})},{key:"reportDepthClick",value:function(e){this.page.rateField.value=e,this.rateFieldChanged()}},{key:"reportDepthVolume",value:function(e){var t=this.page,n=this.market,r=n.baseUnitInfo,o=n.quoteUnitInfo;t.sellBookedBase.textContent=Ee.formatCoinValue(e.sellBase*r.conventional.conversionFactor,r),t.sellBookedQuote.textContent=Ee.formatCoinValue(e.sellQuote*o.conventional.conversionFactor,o),t.buyBookedBase.textContent=Ee.formatCoinValue(e.buyBase*r.conventional.conversionFactor,r),t.buyBookedQuote.textContent=Ee.formatCoinValue(e.buyQuote*o.conventional.conversionFactor,o)}},{key:"reportDepthMouse",value:function(e){for(;this.hovers.length;)this.hovers.shift().classList.remove("hover");var t=this.page;if(e){for(var n=0,r=Object.values(this.metaOrders);n<r.length;n++){var o=r[n],i=[o.row,o.order],a=i[0],s=i[1];2===s.status&&e.hoverMarkers.indexOf(s.rate)>-1&&(a.classList.add("hover"),this.hovers.push(a))}t.hoverPrice.textContent=Ee.formatCoinValue(e.rate),t.hoverVolume.textContent=Ee.formatCoinValue(e.depth),t.hoverVolume.style.color=e.dotColor,Ee.show(t.hoverData)}else Ee.hide(t.hoverData)}},{key:"reportDepthZoom",value:function(e){Ue.store(Fr,e)}},{key:"reportMouseCandle",value:function(e){var t=this.page;e?(t.candleStart.textContent=Ee.formatCoinValue(e.startRate/this.market.rateConversionFactor),t.candleEnd.textContent=Ee.formatCoinValue(e.endRate/this.market.rateConversionFactor),t.candleHigh.textContent=Ee.formatCoinValue(e.highRate/this.market.rateConversionFactor),t.candleLow.textContent=Ee.formatCoinValue(e.lowRate/this.market.rateConversionFactor),t.candleVol.textContent=Ee.formatCoinValue(e.matchVolume,this.market.baseUnitInfo),Ee.show(t.hoverData)):Ee.hide(t.hoverData)}},{key:"parseOrder",value:function(){var e=this.page,t=e.qtyField,n=this.isLimit(),r=this.isSell(),o=this.market;return n||r||(t=e.mktBuyField),{host:o.dex.host,isLimit:n,sell:r,base:o.base.id,quote:o.quote.id,qty:_r(t.value,o.baseUnitInfo.conventional.conversionFactor),rate:_r(e.rateField.value,o.rateConversionFactor),tifnow:e.tifNow.checked}}},{key:"previewQuoteAmt",value:function(e){var t=this.page;if(this.market.base&&this.market.quote){var n=this.parseOrder(),r=this.adjustedRate();if(t.orderErr.textContent="",r&&(n.sell?this.preSell():this.preBuy()),this.depthLines.input=[],r&&this.isLimit()&&(this.depthLines.input=[{rate:n.rate/this.market.rateConversionFactor,color:n.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}]),this.drawChartLines(),!e||!r||!n.qty)return t.orderPreview.textContent="",void this.drawChartLines();var o=ze().assets[n.quote],i=n.qty*n.rate/et,a=Ee.formatCoinValue(i,this.market.quoteUnitInfo);t.orderPreview.textContent=ce(C,{total:a,asset:o.symbol.toUpperCase()}),this.isSell()?this.preSell():this.preBuy()}}},{key:"preSell",value:function(){var e=this;this.maxOrderUpdateCounter++;var t=this.market,n=ze().assets[t.base.id].wallet;n.available<t.cfg.lotsize?this.setMaxOrder({lots:0}):t.maxSell?this.setMaxOrder(t.maxSell.swap):this.schedulePreOrder("/api/maxsell",{},0,(function(r){t.maxSell=r.maxSell,t.sellBalance=n.balance.available,e.setMaxOrder(r.maxSell.swap)}))}},{key:"preBuy",value:function(){var e=this;this.maxOrderUpdateCounter++;var t=this.market,n=this.adjustedRate(),r=ze().assets[t.quote.id].wallet,o=t.cfg.lotsize*(n/et);if(r.balance.available<o)this.setMaxOrder({lots:0});else if(t.maxBuys[n])this.setMaxOrder(t.maxBuys[n].swap);else{var i=t.maxBuys?1e3:0;this.schedulePreOrder("/api/maxbuy",{rate:n},i,(function(r){t.maxBuys[n]=r.maxBuy,t.buyBalance=ze().assets[t.quote.id].wallet.balance.available,e.setMaxOrder(r.maxBuy.swap)}))}}},{key:"schedulePreOrder",value:function(e,t,n,r){var o=this,i=this.page;this.maxLoaded||(this.maxLoaded=ze().loading(i.maxOrd));var a=[this.market.base.id,this.market.quote.id],s=a[0],l=a[1],c=[ze().assets[s].wallet,ze().assets[l].wallet],u=c[0],h=c[1];if(u&&u.running&&h&&h.running){this.preorderTimer&&window.clearTimeout(this.preorderTimer),Ee.show(i.maxOrd,i.maxLotBox),Ee.hide(i.maxAboveZero),i.maxFromLots.textContent=ce(S),i.maxFromLotsLbl.textContent="";var d=this.maxOrderUpdateCounter;this.preorderTimer=window.setTimeout(cr((function*(){if(o.preorderTimer=null,d===o.maxOrderUpdateCounter){var n=yield Ke(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){sr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({host:o.market.dex.host,base:s,quote:l},t));if(d===o.maxOrderUpdateCounter)return ze().checkResponse(n,!0)?void r(n):(console.warn("max order estimate not available:",n),i.maxFromLots.textContent=ce(A),void(o.maxLoaded&&(o.maxLoaded(),o.maxLoaded=null)))}})),n)}}},{key:"setMaxOrder",value:function(e,t){var n=this.page;this.maxLoaded&&(this.maxLoaded(),this.maxLoaded=null),Ee.show(n.maxOrd,n.maxLotBox,n.maxAboveZero);var r,o,i=this.isSell();if(n.maxFromLots.textContent=e.lots.toString(),n.maxFromLotsLbl.textContent=1===e.lots?"lot":"lots",0!==e.lots){var a=(r=i?[this.market.base,this.market.quote]:[this.market.quote,this.market.base],o=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,o)||hr(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],l=a[1];n.maxFromAmt.textContent=Ee.formatCoinValue(e.value,s.info.unitinfo),n.maxFromTicker.textContent=s.symbol.toUpperCase();var c=i?this.adjustedRate()/et:et/this.adjustedRate();n.maxToAmt.textContent=Ee.formatCoinValue(e.value*c,l.info.unitinfo),n.maxToTicker.textContent=l.symbol.toUpperCase()}else Ee.hide(n.maxAboveZero)}},{key:"validateOrder",value:function(e){var t=this.page;return e.isLimit&&!e.rate?(Ee.show(t.orderErr),t.orderErr.textContent=ce(E),!1):!!e.qty||(Ee.show(t.orderErr),t.orderErr.textContent=ce(O),!1)}},{key:"handleBook",value:function(e){var t=this.market,n=t.cfg,r=t.baseUnitInfo,o=t.quoteUnitInfo,i=t.baseCfg,a=t.quoteCfg;this.book=new yn(e,i.symbol,a.symbol),this.loadTable();var s,l=ur(e.book.epoch||[]);try{for(l.s();!(s=l.n()).done;){var c=s.value;c.rate>0&&this.book.add(c),this.addTableOrder(c)}}catch(e){l.e(e)}finally{l.f()}if(!this.book)return this.depthChart.clear(),Ee.empty(this.page.buyRows),void Ee.empty(this.page.sellRows);this.depthChart.set(this.book,n.lotsize,n.ratestep,r,o)}},{key:"midGapConventional",value:function(){var e=this.midGap();if(!e)return e;var t=this.market,n=t.baseUnitInfo,r=t.quoteUnitInfo;return e*n.conventional.conversionFactor/r.conventional.conversionFactor}},{key:"midGap",value:function(){var e=this.book;if(e)return e.buys&&e.buys.length?e.sells&&e.sells.length?(e.buys[0].msgRate+e.sells[0].msgRate)/2/et:e.buys[0].msgRate/et:e.sells&&e.sells.length?e.sells[0].msgRate/et:null}},{key:"setMarketBuyOrderEstimate",value:function(){var e=this.market,t=e.cfg.lotsize,n=ze().user.exchanges[e.dex.host].markets[e.sid].buybuffer,r=this.midGapConventional();r&&(this.page.minMktBuy.textContent=Ee.formatCoinValue(t*n*r,e.baseUnitInfo))}},{key:"ordersSortCompare",value:function(){var e=this;switch(this.ordersSortKey){case"stamp":return function(t,n){return e.ordersSortDirection*(n.stamp-t.stamp)};case"rate":return function(t,n){return e.ordersSortDirection*(t.rate-n.rate)};case"qty":return function(t,n){return e.ordersSortDirection*(t.qty-n.qty)};case"type":return function(t,n){return e.ordersSortDirection*nt(t).localeCompare(nt(n))};case"sell":return function(t,n){return e.ordersSortDirection*tt(t).localeCompare(tt(n))};case"status":return function(t,n){return e.ordersSortDirection*ot(t).localeCompare(ot(n))};case"settled":return function(t,n){return e.ordersSortDirection*(100*it(t)/t.qty-100*it(n)/n.qty)};case"filled":return function(t,n){return e.ordersSortDirection*(100*t.filled/t.qty-100*n.filled/n.qty)}}}},{key:"refreshActiveOrders",value:function(){var e=this,t=this.page,n=this.metaOrders,r=this.market;for(var o in n)delete n[o];var i=ze().orders(r.dex.host,jr(r.baseCfg.symbol,r.quoteCfg.symbol)),a=this.ordersSortCompare();i.sort(a),Ee.empty(t.liveList);var s,l=ur(i);try{var c=function(){var r=s.value,o=t.liveTemplate.cloneNode(!0);if(n[r.id]={row:o,order:r},Ee.bind(o,"mouseenter",(function(t){e.activeMarkerRate=r.rate,e.setDepthMarkers()})),e.updateUserOrderRow(o,r),1===r.type&&1===r.tif&&r.status<3){var i=Ee.tmplElement(o,"cancelBttn");Ee.show(i),wr(i,"click",(function(t){t.stopPropagation(),e.showCancel(o,r.id)}))}Ee.tmplElement(o,"side").classList.add(r.sell?"sellcolor":"buycolor"),Ee.tmplElement(o,"link").href="order/".concat(r.id),ze().bindInternalNavigation(o),t.liveList.appendChild(o),ze().bindTooltips(o)};for(l.s();!(s=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}this.setDepthMarkers()}},{key:"updateUserOrderRow",value:function(e,t){Ur(e,"type",nt(t)),Ur(e,"side",tt(t)),Ur(e,"age",Ee.timeSince(t.stamp)),Ur(e,"rate",Ee.formatCoinValue(t.rate/this.market.rateConversionFactor)),Ur(e,"qty",Ee.formatCoinValue(t.qty,this.market.baseUnitInfo)),Ur(e,"filled","".concat((t.filled/t.qty*100).toFixed(1),"%")),Ur(e,"settled","".concat((it(t)/t.qty*100).toFixed(1),"%")),Ur(e,"status",ot(t))}},{key:"setDepthMarkers",value:function(){for(var e={buys:[],sells:[]},t=this.market.rateConversionFactor,n=0,r=Object.values(this.metaOrders);n<r.length;n++){var o=r[n].order;o.rate&&2===o.status&&(o.sell?e.sells.push({rate:o.rate/t,active:o.rate===this.activeMarkerRate}):e.buys.push({rate:o.rate/t,active:o.rate===this.activeMarkerRate}))}this.depthChart.setMarkers(e),this.book&&this.depthChart.draw()}},{key:"updateTitle",value:function(){var e=this.midGapConventional();if(e){var t=this.market,n=t.baseCfg,r=t.quoteCfg,o=n.symbol.toUpperCase(),i=r.symbol.toUpperCase();document.title="".concat(Ee.formatCoinValue(e)," | ").concat(o).concat(i," | ").concat(this.ogTitle)}}},{key:"handleBookRoute",value:function(e){var t=this;ze().log("book","handleBookRoute:",e);var n=e.payload,r=this.market,o=this.page,i=r.dex.host,a=[r.baseCfg,r.quoteCfg],s=a[0],l=a[1];n.base===s.id&&n.quote===l.id&&(this.refreshActiveOrders(),this.handleBook(n),this.updateTitle(),Ee.hide(o.marketLoader),this.marketList.select(i,s.id,l.id),Ue.store(Er,{host:e.host,base:n.base,quote:n.quote}),o.lotSize.textContent=Ee.formatCoinValue(r.cfg.lotsize,r.baseUnitInfo),o.rateStep.textContent=Ee.formatCoinValue(r.cfg.ratestep/r.rateConversionFactor),this.baseUnits.forEach((function(e){e.textContent=s.symbol.toUpperCase()})),this.quoteUnits.forEach((function(e){e.textContent=l.symbol.toUpperCase()})),this.balanceWgt.setWallets(i,s.id,l.id),this.setMarketBuyOrderEstimate(),this.refreshActiveOrders(),this.loaded&&(this.loaded(),this.loaded=null,Ee.animate(250,(function(e){t.main.style.opacity=e}))))}},{key:"handleBookOrderRoute",value:function(e){if(ze().log("book","handleBookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.rate>0&&this.book.add(t),this.addTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUnbookOrderRoute",value:function(e){if(ze().log("book","handleUnbookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.remove(t.token),this.removeTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUpdateRemainingRoute",value:function(e){if(ze().log("book","handleUpdateRemainingRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.updateRemaining(t.token,t.qty,t.qtyAtomic),this.updateTableOrder(t),this.depthChart.draw()}}},{key:"handleEpochOrderRoute",value:function(e){if(ze().log("book","handleEpochOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.msgRate>0&&this.book.add(t),t.qtyAtomic>0&&this.addTableOrder(t),this.depthChart.draw()}}},{key:"handleCandlesRoute",value:function(e){if(this.candlesLoading&&(clearTimeout(this.candlesLoading.timer),this.candlesLoading.loaded(),this.candlesLoading=null),this.depthChart.hide(),this.candleChart.show(),e.host===this.market.dex.host){var t=e.payload.dur;this.market.candleCaches[t]=e.payload,this.currentChart===Ir&&this.candleDur===t&&this.candleChart.setCandles(e.payload,this.market.cfg,this.market.baseUnitInfo,this.market.quoteUnitInfo)}}},{key:"handleCandleUpdateRoute",value:function(e){if(e.host===this.market.dex.host){var t=e.payload,n=t.dur,r=t.candle,o=this.market.candleCaches[n];if(o){var i=o.candles;0===i.length?i.push(r):i[i.length-1].startStamp===r.startStamp?i[i.length-1]=r:i.push(r),this.currentChart===Ir&&this.candleDur===n&&this.candleChart.draw()}}}},{key:"showForm",value:(s=cr((function*(e){this.currentForm=e;var t=this.page;Ee.hide(t.unlockWalletForm,t.verifyForm,t.newWalletForm,t.cancelForm),e.style.right="10000px",Ee.show(t.forms,e);var n=(t.forms.offsetWidth+e.offsetWidth)/2;yield Ee.animate(500,(function(t){e.style.right="".concat((1-t)*n,"px")}),"easeOutHard"),e.style.right="0"})),function(e){return s.apply(this,arguments)})},{key:"showOpen",value:(a=cr((function*(e,t){var n=this.page;this.openAsset=e,this.openFunc=t,this.unlockForm.setAsset(ze().assets[e.id]),this.showForm(n.unlockWalletForm),n.uwAppPass.focus()})),function(e,t){return a.apply(this,arguments)})},{key:"showVerify",value:function(){var e=this.page,t=this.parseOrder(),n=t.sell,r=ze().assets[t.base],o=ze().assets[t.quote],i=n?o:r,a=n?r:o;if(e.vQty.textContent=Ee.formatCoinValue(t.qty,r.info.unitinfo),e.vSideHeader.textContent=ce(n?b:w),e.vSideSubmit.textContent=e.vSideHeader.textContent,e.vBaseSubmit.textContent=r.symbol.toUpperCase(),t.isLimit)Ee.show(e.verifyLimit),Ee.hide(e.verifyMarket),e.vRate.textContent=Ee.formatCoinValue(t.rate/this.market.rateConversionFactor),e.vQuote.textContent=o.symbol.toUpperCase(),e.vTotal.textContent=Ee.formatCoinValue(t.rate/et*t.qty,o.info.unitinfo),e.vBase.textContent=r.symbol.toUpperCase(),e.vSide.textContent=n?ce(b).toLowerCase():ce(w).toLowerCase();else{Ee.hide(e.verifyLimit),Ee.show(e.verifyMarket),e.vSide.textContent=ce(F),e.vBase.textContent=a.symbol.toUpperCase();var s=this.midGap();if(s){var l=t.sell?t.qty*s:t.qty/s,c=this.market.cfg.lotsize,u=t.sell?t.qty/c:l/c;e.vmTotal.textContent=Ee.formatCoinValue(l,i.info.unitinfo),e.vmAsset.textContent=i.symbol.toUpperCase(),e.vmLots.textContent=u.toFixed(1)}else Ee.hide(e.verifyMarket)}var h="buygreen",d="sellred";n?(e.vHeader.classList.add(d),e.vHeader.classList.remove(h),e.vSubmit.classList.add(d),e.vSubmit.classList.remove(h)):(e.vHeader.classList.add(h),e.vHeader.classList.remove(d),e.vSubmit.classList.add(h),e.vSubmit.classList.remove(d)),this.showForm(e.verifyForm),e.vPass.focus()}},{key:"submitCancel",value:(i=cr((function*(){var e=this.page,t=this.cancelData,n=t.order,r={orderID:n.id,pw:e.cancelPass.value};e.cancelPass.value="";var o=yield Ke("/api/cancel",r);ze().checkResponse(o)&&(Ee.hide(t.bttn,e.forms),n.cancelling=!0)})),function(){return i.apply(this,arguments)})},{key:"showCancel",value:function(e,t){var n=this.metaOrders[t].order,r=this.page,o=n.qty-n.filled,i=rt(n)?this.market.quote:this.market.base;r.cancelRemain.textContent=Ee.formatCoinValue(o,i.info.unitinfo),r.cancelUnit.textContent=i.symbol.toUpperCase(),this.showForm(r.cancelForm),r.cancelPass.focus(),this.cancelData={bttn:Ee.tmplElement(e,"cancelBttn"),order:n}}},{key:"showCreate",value:function(e){var t=this.page;this.currentCreate=e,this.newWalletForm.setAsset(e.id),this.showForm(t.newWalletForm),this.newWalletForm.loadDefaults()}},{key:"stepSubmit",value:function(){var e=this.page,t=this.market;if(Ee.hide(e.orderErr),this.validateOrder(this.parseOrder())){var n=ze().walletMap[t.base.id],r=ze().walletMap[t.quote.id];return n?r?void this.showVerify():(e.orderErr.textContent=ce(R,{asset:t.quote.symbol}),void Ee.show(e.orderErr)):(e.orderErr.textContent=ce(R,{asset:t.base.symbol}),void Ee.show(e.orderErr))}}},{key:"handleWalletStateNote",value:function(e){this.balanceWgt.updateAsset(e.wallet.assetID)}},{key:"handlePriceUpdate",value:function(e){for(var t=this.marketList.xcSection(e.host),n=0,r=Object.values(e.spots);n<r.length;n++){var o=r[n],i=t.marketRow(o.baseID,o.quoteID);i&&i.setSpot(o)}}},{key:"handleFeePayment",value:function(e){var t=e.dex;t===this.market.dex.host&&(this.market.dex=ze().exchanges[t],this.setRegistrationStatusVisibility())}},{key:"handleOrderNote",value:function(e){var t=e.order,n=this.metaOrders[t.id];if(!n)return this.refreshActiveOrders();var r=n.status;n.order=t;var o=Ee.tmplElement(n.row,"cancelBttn");"MissedCancel"===e.topic&&Ee.show(o),t.filled===t.qty&&Ee.hide(o),this.updateUserOrderRow(n.row,t),(1===r&&2===t.status||2===r&&t.status>2)&&this.setDepthMarkers()}},{key:"handleEpochNote",value:function(e){if(ze().log("book","handleEpochNote:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){this.book&&(this.book.setEpoch(e.epoch),this.depthChart.draw()),this.clearOrderTableEpochs(e.epoch);for(var t=0,n=Object.values(this.metaOrders);t<n.length;t++){var r=n[t],o=r.order,i=e.epoch>o.epoch,a=Ee.tmplElement(r.row,"status");switch(!0){case 1===o.type&&1===o.status&&i:a.textContent=0===o.tif?ce(I):ce(T),o.status=0===o.tif?3:2;break;case 2===o.type&&1===o.status:a.textContent=ce(I),o.status=3}}}}},{key:"setBalanceVisibility",value:function(){this.market.dex.connected?Ee.show(this.page.balanceTable):Ee.hide(this.page.balanceTable)}},{key:"handleBalanceNote",value:function(e){if(this.setBalanceVisibility(),this.market.dex.connected){this.balanceWgt.updateAsset(e.assetID);var t=this.market,n=e.balance.available;switch(e.assetID){case t.baseCfg.id:if(!t.maxSell)break;"number"==typeof t.sellBalance&&t.sellBalance!==n&&(t.maxSell=null),this.isSell()&&this.preSell();break;case t.quoteCfg.id:if(!Object.keys(t.maxBuys).length)break;"number"==typeof t.buyBalance&&t.buyBalance!==n&&(t.maxBuys={}),this.isSell()||this.preBuy()}}}},{key:"submitOrder",value:(o=cr((function*(){var e=this.page;Ee.hide(e.orderErr,e.vErr);var t=this.parseOrder(),n=e.vPass.value;e.vPass.value="";var r={order:t,pw:n};if(this.validateOrder(t)){e.vSubmit.classList.add("d-hide"),e.vLoader.classList.remove("d-hide");var o=yield Ke("/api/trade",r);if(e.vSubmit.classList.remove("d-hide"),e.vLoader.classList.add("d-hide"),!ze().checkResponse(o,!0))return e.vErr.textContent=o.msg,void Ee.show(e.vErr);Ee.hide(e.forms),this.refreshActiveOrders(),this.depthChart.draw()}})),function(){return o.apply(this,arguments)})},{key:"createWallet",value:(r=cr((function*(){var e=(yield ze().fetchUser()).assets[this.currentCreate.id];Ee.hide(this.page.forms),this.balanceWgt.updateAsset(e.id),this.resolveOrderFormVisibility()})),function(){return r.apply(this,arguments)})},{key:"walletUnlocked",value:(n=cr((function*(){Ee.hide(this.page.forms),this.balanceWgt.updateAsset(this.openAsset.id)})),function(){return n.apply(this,arguments)})},{key:"lotChanged",value:function(){var e=this.page,t=parseInt(e.lotField.value);if(t<=0)return e.lotField.value=0,void(e.qtyField.value="");var n=this.market.cfg.lotsize;e.lotField.value=t,e.qtyField.value=t*n/this.market.baseUnitInfo.conventional.conversionFactor,this.previewQuoteAmt(!0)}},{key:"quantityChanged",value:function(e){var t=this.page,n=this.parseOrder();if(n.qty<=0)return t.lotField.value=0,void(t.qtyField.value="");var r=this.market.cfg.lotsize,o=Math.floor(n.qty/r),i=o*r;t.lotField.value=o,(n.isLimit||n.sell)&&(e&&(t.qtyField.value=i/this.market.baseUnitInfo.conventional.conversionFactor),this.previewQuoteAmt(!0))}},{key:"marketBuyChanged",value:function(){var e=this.page,t=_r(e.mktBuyField.value,this.market.quoteUnitInfo.conventional.conversionFactor),n=this.midGap();if(!n||!t)return e.mktBuyLots.textContent="0",void(e.mktBuyScore.textContent="0");var r=this.market.cfg.lotsize,o=t/n;e.mktBuyLots.textContent=(o/r).toFixed(1),e.mktBuyScore.textContent=Ee.formatCoinValue(o,this.market.baseUnitInfo)}},{key:"rateFieldChanged",value:function(){var e=this.adjustedRate();if(e<=0)return this.depthLines.input=[],this.drawChartLines(),void(this.page.rateField.value=0);var t=this.parseOrder(),n=e/this.market.rateConversionFactor;this.page.rateField.value=n,this.depthLines.input=[{rate:n,color:t.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}],this.drawChartLines(),this.previewQuoteAmt(!0)}},{key:"adjustedRate",value:function(){var e=this.page.rateField.value;if(!e)return null;var t=_r(e,this.market.rateConversionFactor);return t-t%this.market.cfg.ratestep}},{key:"loadTable",value:function(){this.loadTableSide(!0),this.loadTableSide(!1)}},{key:"binOrdersByRateAndEpoch",value:function(e){if(!e||!e.length)return[];var t=[],n=[],r=[],o=e[0].msgRate;e[0].epoch?n.push(e[0]):r.push(e[0]);for(var i=1;i<e.length;i++)e[i].msgRate!==o&&(t.push(r),t.push(n),n=[],r=[],o=e[i].msgRate),e[i].epoch?n.push(e[i]):r.push(e[i]);return t.push(r),t.push(n),t.filter((function(e){return e.length>0}))}},{key:"loadTableSide",value:function(e){var t=this,n=e?this.book.sells:this.book.buys,r=e?this.page.sellRows:this.page.buyRows;Ee.empty(r),n&&n.length&&this.binOrdersByRateAndEpoch(n).forEach((function(e){r.appendChild(t.orderTableRow(e))}))}},{key:"addTableOrder",value:function(e){var t=e.sell?this.page.sellRows:this.page.buyRows,n=t.firstChild;if(0!==e.rate){for(n&&0===n.manager.getRate()&&(n=n.nextSibling);n;){if(0===n.manager.compare(e))return void n.manager.insertOrder(e);if(n.manager.compare(e)>0){var r=this.orderTableRow([e]);return void t.insertBefore(r,n)}n=n.nextSibling}var o=this.orderTableRow([e]);t.appendChild(o)}else n&&0===n.manager.getRate()?n.manager.insertOrder(e):(n=this.orderTableRow([e]),t.insertBefore(n,t.firstChild))}},{key:"removeTableOrder",value:function(e){for(var t=e.token,n=0,r=[this.page.sellRows,this.page.buyRows];n<r.length;n++)for(var o=r[n],i=0,a=Array.from(o.children);i<a.length;i++)if(a[i].manager.removeOrder(t))return}},{key:"updateTableOrder",value:function(e){for(var t=0,n=[this.page.sellRows,this.page.buyRows];t<n.length;t++)for(var r=n[t],o=0,i=Array.from(r.children);o<i.length;o++)if(i[o].manager.updateOrderQty(e))return}},{key:"clearOrderTableEpochs",value:function(e){this.clearOrderTableEpochSide(this.page.sellRows),this.clearOrderTableEpochSide(this.page.buyRows)}},{key:"clearOrderTableEpochSide",value:function(e,t){for(var n=0,r=Array.from(e.children);n<r.length;n++)r[n].manager.removeEpochOrders()}},{key:"orderTableRow",value:function(e){var t=this,n=this.page.rowTemplate.cloneNode(!0),r=this.market,o=r.baseUnitInfo,i=r.rateConversionFactor,a=new zr(n,e,o,i);return n.manager=a,wr(n,"click",(function(){t.reportDepthClick(n.manager.getRate()/i)})),0!==n.manager.getRate()&&Ee.bind(n,"mouseenter",(function(e){var r=t.depthChart;t.depthLines.hover=[{rate:n.manager.getRate()/i,color:n.manager.isSell()?r.theme.sellLine:r.theme.buyLine}],t.drawChartLines()})),n}},{key:"handleConnNote",value:(t=cr((function*(e){this.marketList.setConnectionStatus(e),e.connected&&(yield ze().fetchUser(),ze().loadPage("markets"))})),function(e){return t.apply(this,arguments)})},{key:"filterMarkets",value:function(){var e=this.page.marketSearch.value,t=e?function(t){return t.name.includes(e)}:function(){return!0};this.marketList.setFilter(t)}},{key:"drawChartLines",value:function(){this.depthChart.setLines([].concat(ir(this.depthLines.hover),ir(this.depthLines.input))),this.depthChart.draw()}},{key:"depthChartSelected",value:function(){var e=this.page;Ee.hide(e.depthBttn,e.durBttnBox,e.candleHoverData),Ee.show(e.candlestickBttn,e.epochLine,e.depthHoverData,e.depthSummary),this.currentChart=Rr,this.depthChart.show(),this.candleChart.hide()}},{key:"candleChartSelected",value:function(){var e=this.page,t=this.market.dex;this.currentChart=Ir,Ee.hide(e.candlestickBttn,e.epochLine,e.depthHoverData,e.depthSummary),Ee.show(e.depthBttn,e.durBttnBox,e.candleHoverData),-1===t.candleDurs.indexOf(this.candleDur)&&(this.candleDur=t.candleDurs[0]),this.loadCandles()}},{key:"candleDurationSelected",value:function(e){this.candleDur=e,this.loadCandles()}},{key:"loadCandles",value:function(){var e,t=ur(this.page.durBttnBox.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.textContent===this.candleDur?n.classList.add("selected"):n.classList.remove("selected")}}catch(e){t.e(e)}finally{t.f()}var r=this.market,o=r.candleCaches,i=r.cfg,a=o[this.candleDur];if(a)return this.depthChart.hide(),this.candleChart.show(),void this.candleChart.setCandles(a,i);this.requestCandles()}},{key:"requestCandles",value:function(){var e=this;this.candlesLoading={loaded:function(){Ee.hide(e.page.marketLoader)},timer:setTimeout((function(){e.candlesLoading&&(e.candlesLoading=null,Ee.hide(e.page.marketLoader),console.error("candles not received"))}),1e4)};var t=this.market,n=t.dex,r=t.baseCfg,o=t.quoteCfg;rr.request("loadcandles",{host:n.host,base:r.id,quote:o.id,dur:this.candleDur})}},{key:"unload",value:function(){rr.request("unmarket",{}),rr.deregisterRoute(br),rr.deregisterRoute(Cr),rr.deregisterRoute(kr),rr.deregisterRoute(xr),rr.deregisterRoute(Sr),rr.deregisterRoute(Ar),this.depthChart.unattach(),this.candleChart.unattach(),Ee.unbind(document,"keyup",this.keyup),clearInterval(this.secondTicker)}}]),p}(He),Lr=function(){function e(t){fr(this,e),this.selected=null;var n=Ee.tmplElement(t,"xc");Ee.cleanTemplates(n),this.xcSections=[];for(var r=0,o=Object.values(ze().user.exchanges);r<o.length;r++){var i=o[r];this.xcSections.push(new Br(n,i))}var a,s=ur(this.sortedSections());try{for(s.s();!(a=s.n()).done;){var l=a.value;t.appendChild(l.node)}}catch(e){s.e(e)}finally{s.f()}}return mr(e,[{key:"sortedSections",value:function(){return ir(this.xcSections).sort((function(e,t){return e.host<t.host?-1:1}))}},{key:"xcSection",value:function(e){var t,n=ur(this.xcSections);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.host===e)return r}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"exists",value:function(e,t,n){var r=this.xcSection(e);if(!r)return!1;var o,i=ur(r.marketRows);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(a.baseID===t&&a.quoteID===n)return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"first",value:function(){var e=this.sortedSections()[0],t=e.first();return t?Mr(e.host,t.baseID,t.quoteID):Mr(e.host)}},{key:"select",value:function(e,t,n){this.selected&&this.selected.node.classList.remove("selected"),this.selected=this.xcSection(e).marketRow(t,n),this.selected.node.classList.add("selected")}},{key:"setConnectionStatus",value:function(e){this.xcSection(e.host).setConnected(e.connected)}},{key:"setFilter",value:function(e){var t,n=ur(this.xcSections);try{for(n.s();!(t=n.n()).done;)t.value.setFilter(e)}catch(e){n.e(e)}finally{n.f()}}}]),e}(),Br=function(){function e(t,n){fr(this,e),this.dex=n,this.host=n.host,this.node=t.cloneNode(!0);var r=Ee.parseTemplate(this.node);if(r.header.textContent=n.host,this.disconnectedIco=r.disconnected,n.connected&&Ee.hide(r.disconnected),r.mkts.removeChild(r.mktrow),n.markets){this.marketRows=Object.values(n.markets).map((function(e){return new Wr(r.mktrow,e)}));var o,i=ur(this.sortedMarkets());try{for(i.s();!(o=i.n()).done;){var a=o.value;r.mkts.appendChild(a.node)}}catch(e){i.e(e)}finally{i.f()}}}return mr(e,[{key:"sortedMarkets",value:function(){return ir(this.marketRows).sort((function(e,t){return e.name<t.name?-1:1}))}},{key:"first",value:function(){return this.sortedMarkets()[0]}},{key:"marketRow",value:function(e,t){var n,r=ur(this.marketRows);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.baseID===e&&o.quoteID===t)return o}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"setConnected",value:function(e){e?Ee.hide(this.disconnectedIco):Ee.show(this.disconnectedIco)}},{key:"setFilter",value:function(e){var t,n=ur(this.marketRows);try{for(n.s();!(t=n.n()).done;){var r=t.value;e(r)?Ee.show(r.node):Ee.hide(r.node)}}catch(e){n.e(e)}finally{n.f()}}}]),e}(),Wr=function(){function e(t,n){fr(this,e),this.mkt=n,this.name=n.name,this.baseID=n.baseid,this.quoteID=n.quoteid,this.lotSize=n.lotsize,this.rateStep=n.ratestep,this.node=t.cloneNode(!0);var r=this.tmpl=Ee.parseTemplate(this.node);r.baseIcon.src=Ee.logoPath(n.basesymbol),r.quoteIcon.src=Ee.logoPath(n.quotesymbol),r.baseSymbol.textContent=n.basesymbol.toUpperCase(),r.quoteSymbol.textContent=n.quotesymbol.toUpperCase(),this.setSpot(n.spot)}return mr(e,[{key:"setSpot",value:function(e){if(e){var t=this.tmpl,n=this.mkt;Ee.show(t.pctChange);var r=100*e.change24,o=Dr.format(r),i=r>0?"+":"";t.pctChange.textContent="".concat(i).concat(o,"%"),t.pctChange.classList.remove("upgreen","downred","grey"),t.pctChange.classList.add(0===r?"grey":r>0?"upgreen":"downred");var a=ze().assets[n.baseid];a&&(Ee.show(t.bottomRow),t.assetName.textContent=a.info.name,t.price.textContent=Ee.formatCoinValue(e.rate/1e8))}}}]),e}(),qr=function(){function e(t){fr(this,e);var n=Ee.idDescendants(t);this.base={id:0,cfg:null,logo:n.baseImg,avail:n.baseAvail,newWalletRow:n.baseNewWalletRow,newWalletBttn:n.baseNewButton,locked:n.baseLocked,immature:n.baseImmature,unsupported:n.baseUnsupported,expired:n.baseExpired,connect:n.baseConnect,spinner:n.baseSpinner,iconBox:n.baseWalletState,stateIcons:new Fe(n.baseWalletState)},this.quote={id:0,cfg:null,logo:n.quoteImg,avail:n.quoteAvail,newWalletRow:n.quoteNewWalletRow,newWalletBttn:n.quoteNewButton,locked:n.quoteLocked,immature:n.quoteImmature,unsupported:n.quoteUnsupported,expired:n.quoteExpired,connect:n.quoteConnect,spinner:n.quoteSpinner,iconBox:n.quoteWalletState,stateIcons:new Fe(n.quoteWalletState)},this.dex=null}return mr(e,[{key:"setWallets",value:function(e,t,n){this.dex=ze().user.exchanges[e],this.base.id=t,this.base.cfg=this.dex.assets[t],this.quote.id=n,this.quote.cfg=this.dex.assets[n],this.updateWallet(this.base),this.updateWallet(this.quote)}},{key:"updateWallet",value:function(e){var t=ze().assets[e.id];if(Ee.hide(e.newWalletRow,e.avail,e.immature,e.locked,e.expired,e.unsupported,e.connect,e.spinner,e.iconBox),e.logo.src=Ee.logoPath(e.cfg.symbol),t){Ee.show(e.iconBox);var n=t.wallet;if(e.stateIcons.readWallet(n),n){var r=n.balance;if(r||n.running){if(!r)return ze().fetchBalance(e.id),void Ee.show(e.spinner);Ee.show(e.avail,e.immature,e.locked),e.avail.textContent=Ee.formatCoinValue(r.available,t.info.unitinfo),e.locked.textContent=Ee.formatCoinValue(r.locked+r.contractlocked,t.info.unitinfo),e.immature.textContent=Ee.formatCoinValue(r.immature,t.info.unitinfo),(new Date).getTime()-new Date(r.stamp).getTime()>36e5?(Ee.show(e.expired),n.running&&ze().fetchBalance(e.id)):Ee.hide(e.expired)}else Ee.show(e.connect)}else Ee.show(e.newWalletRow)}else Ee.show(e.unsupported)}},{key:"updateAsset",value:function(e){e===this.base.id?this.updateWallet(this.base):e===this.quote.id&&this.updateWallet(this.quote)}}]),e}();function Mr(e,t,n){return{host:e,base:t,quote:n}}function jr(e,t){return"".concat(e,"_").concat(t)}function _r(e,t){return Math.round(parseFloat(e)*t)}function Nr(e,t){e.classList.remove("selected"),t.classList.add("selected")}function Ur(e,t,n){Ee.tmplElement(e,t).textContent=n}var zr=function(){function e(t,n,r,o){fr(this,e),this.tableRow=t,this.orderBin=n,this.sell=n[0].sell,this.msgRate=n[0].msgRate,this.epoch=!!n[0].epoch,this.baseUnitInfo=r,this.rateConversionFactor=o,this.setRateEl(),this.setEpochEl(),this.updateQtyNumOrdersEl()}return mr(e,[{key:"setEpochEl",value:function(){var e=Ee.tmplElement(this.tableRow,"epoch");this.isEpoch()&&e.appendChild(Tr.cloneNode())}},{key:"setRateEl",value:function(){var e=Ee.tmplElement(this.tableRow,"rate");if(0===this.msgRate)e.innerText="market";else{var t=this.isSell()?"sellcolor":"buycolor";e.innerText=Ee.formatFullPrecision(this.msgRate/this.rateConversionFactor),e.classList.add(t)}}},{key:"updateQtyNumOrdersEl",value:function(){var e=this.orderBin.reduce((function(e,t){return e+t.qtyAtomic}),0),t=this.orderBin.length,n=Ee.tmplElement(this.tableRow,"qty"),r=Ee.tmplElement(this.tableRow,"numorders");n.innerText=Ee.formatFullPrecision(e,this.baseUnitInfo),t>1?(r.removeAttribute("hidden"),r.innerText=t,r.title="quantity is comprised of ".concat(t," orders")):r.setAttribute("hidden",!0)}},{key:"insertOrder",value:function(e){this.orderBin.push(e),this.updateQtyNumOrdersEl()}},{key:"updateOrderQty",value:function(e){for(var t=e.token,n=e.qty,r=e.qtyAtomic,o=0;o<this.orderBin.length;o++)if(this.orderBin[o].token===t)return this.orderBin[o].qty=n,this.orderBin[o].qtyAtomic=r,this.updateQtyNumOrdersEl(),!0;return!1}},{key:"removeOrder",value:function(e){var t=this.orderBin.findIndex((function(t){return t.token===e}));return!(t<0||(this.orderBin.splice(t,1),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove(),0))}},{key:"removeEpochOrders",value:function(e){this.orderBin=this.orderBin.filter((function(t){return!(t.epoch&&t.epoch!==e)})),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove()}},{key:"getRate",value:function(){return this.msgRate}},{key:"isEpoch",value:function(){return this.epoch}},{key:"isSell",value:function(){return this.sell}},{key:"compare",value:function(e){return this.getRate()===e.msgRate&&this.isEpoch()===!!e.epoch?0:this.getRate()!==e.msgRate?this.getRate()>e.msgRate===e.sell?1:-1:this.isEpoch()?1:-1}}]),e}();function Vr(e){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hr(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Xr(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Hr(i,r,o,a,s,"next",e)}function s(e){Hr(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Qr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kr(e,t){return(Kr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zr(e,t){if(t&&("object"===Vr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $r(e){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jr,eo,to,no=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kr(e,t)}(c,e);var t,n,r,o,i,a,s,l=(a=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$r(a);if(s){var n=$r(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Zr(this,e)});function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=l.call(this)).main=e,t.offset="",t.loading=!1;var n=t.page=Ee.idDescendants(e);t.orderTmpl=n.rowTmpl,t.orderTmpl.remove();var r=t.filterState={hosts:[],assets:[],statuses:[]},o=new URLSearchParams(window.location.search),i=function(e,t){var n=o.get(t);if(n&&0!==n.length){var i=n.split(",");n&&(r[t]=i),e.querySelectorAll("input").forEach((function(e){i.indexOf(e.value)>=0&&(e.checked=!0)}))}};i(n.hostFilter,"hosts"),i(n.assetFilter,"assets"),i(n.statusFilter,"statuses");var a=[],s=function(e,n){var o=e.querySelector(".apply-bttn");a.push(o),Ee.bind(o,"click",(function(){t.submitFilter(),a.forEach((function(e){return Ee.hide(e)}))})),e.querySelectorAll("input").forEach((function(t){Ee.bind(t,"change",(function(){!function(e,t){if(e.length!==t.length)return!1;var n,r=Qr(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(-1===t.indexOf(o))return!1}}catch(e){r.e(e)}finally{r.f()}return!0}(ro(e),r[n])?Ee.show(o):Ee.hide(o)}))}))};return s(n.hostFilter,"hosts"),s(n.assetFilter,"assets"),s(n.statusFilter,"statuses"),Ee.bind(t.main,"scroll",(function(){t.loading||n.ordersTable.offsetHeight-t.main.offsetHeight-t.main.scrollTop<0&&t.nextPage()})),Ee.bind(n.exportOrders,"click",(function(){t.exportOrders()})),t.submitFilter(),t}return t=c,(n=[{key:"setOrders",value:function(e){Ee.empty(this.page.tableBody),this.appendOrders(e)}},{key:"appendOrders",value:function(e){var t,n=this,r=this.page.tableBody,o=Qr(e);try{var i=function(){var e=t.value,o=n.orderTmpl.cloneNode(!0),i=function(e,t){Ee.tmplElement(o,e).textContent=t},a="".concat(e.baseSymbol.toUpperCase(),"-").concat(e.quoteSymbol.toUpperCase());i("host","".concat(a," @ ").concat(e.host));var s=void 0,l=void 0,c=void 0,u="",h=[ze().unitInfo(e.baseID),ze().unitInfo(e.quoteID)],d=h[0],f=h[1];if(e.sell){var p=[e.baseSymbol,e.quoteSymbol];s=p[0],l=p[1],c=Ee.formatCoinValue(e.qty,d),1===e.type&&(u=Ee.formatCoinValue(e.qty/et*e.rate,f))}else{var m=[e.quoteSymbol,e.baseSymbol];s=m[0],l=m[1],2===e.type?c=Ee.formatCoinValue(e.qty,d):(c=Ee.formatCoinValue(e.qty/et*e.rate,f),u=Ee.formatCoinValue(e.qty,d))}i("fromQty",c),Ee.tmplElement(o,"fromLogo").src=Ee.logoPath(s),i("fromSymbol",s),i("toQty",u),Ee.tmplElement(o,"toLogo").src=Ee.logoPath(l),i("toSymbol",l),i("type","".concat(nt(e)," ").concat(tt(e))),i("rate",Ee.formatCoinValue(ze().conventionalRate(e.baseID,e.quoteID,e.rate))),i("status",ot(e)),i("filled","".concat((e.filled/e.qty*100).toFixed(1),"%")),i("settled","".concat((it(e)/e.qty*100).toFixed(1),"%"));var y=new Date(e.stamp).toLocaleString();i("time","".concat(Ee.timeSince(e.stamp)," ago, ").concat(y)),Ee.tmplElement(o,"link").href="order/".concat(e.id),ze().bindInternalNavigation(o),r.appendChild(o)};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}50===e.length?this.offset=e[e.length-1].id:this.offset=""}},{key:"submitFilter",value:(i=Xr((function*(){var e=this.page;this.offset="";var t=this.filterState;t.hosts=ro(e.hostFilter),t.assets=ro(e.assetFilter),t.statuses=ro(e.statusFilter),this.setOrders(yield this.fetchOrders())})),function(){return i.apply(this,arguments)})},{key:"fetchOrders",value:(o=Xr((function*(){var e=ze().loading(this.main),t=yield Ke("/api/orders",this.currentFilter());return e(),t.orders})),function(){return o.apply(this,arguments)})},{key:"exportOrders",value:function(){this.offset="";var e=this.currentFilter(),t=new URL(window.location),n=new URLSearchParams(""),r=function(t){e[t].forEach((function(e){n.append(t,e)}))};r("hosts"),r("assets"),r("statuses"),t.search=n.toString(),t.pathname="/orders/export",window.open(t.toString())}},{key:"currentFilter",value:function(){var e=this.filterState;return{hosts:e.hosts,assets:e.assets.map((function(e){return parseInt(e)})),statuses:e.statuses.map((function(e){return parseInt(e)})),n:50,offset:this.offset}}},{key:"nextPage",value:(r=Xr((function*(){if(""!==this.offset&&!this.loading){this.loading=!0,Ee.show(this.page.orderLoader);var e=yield this.fetchOrders();this.loading=!1,Ee.hide(this.page.orderLoader),this.appendOrders(e)}})),function(){return r.apply(this,arguments)})}])&&Gr(t.prototype,n),c}(He);function ro(e){var t=[];return e.querySelectorAll("input").forEach((function(e){e.checked&&t.push(e.value)})),t}function oo(e){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function io(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ao(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||lo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function so(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=lo(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function lo(e,t){if(e){if("string"==typeof e)return co(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?co(e,t):void 0}}function co(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uo(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function ho(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){uo(i,r,o,a,s,"next",e)}function s(e){uo(i,r,o,a,s,"throw",e)}a(void 0)}))}}function fo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function po(e,t){return(po=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mo(e,t){if(t&&("object"===oo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vo,go=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&po(e,t)}(c,e);var t,n,r,o,i,a,s,l=(a=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yo(a);if(s){var n=yo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return mo(this,e)});function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),t=l.call(this);var n=e.querySelectorAll("[data-stamp]");vo=parseInt(e.dataset.net),t.orderID=e.dataset.oid,t.order=ze().order(t.orderID),t.order||t.fetchOrder();var r=t.page=Ee.idDescendants(e);r.cancelBttn&&Ee.bind(r.cancelBttn,"click",(function(){t.showForm(r.cancelForm)})),Ee.bind(r.forms,"mousedown",(function(e){Ee.mouseInElement(e,t.currentForm)||(Ee.hide(r.forms),r.cancelPass.value="")})),Et(r.cancelForm,r.cancelSubmit,ho((function*(){t.submitCancel()}))),e.querySelectorAll("[data-explorer-id]").forEach((function(e){bo(e)}));var o=function(){var e,t=so(n);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.textContent=Ee.timeSince(parseInt(r.dataset.stamp))}}catch(e){t.e(e)}finally{t.f()}};return o(),t.secondTicker=setInterval((function(){o()}),1e4),t.notifiers={order:function(e){t.handleOrderNote(e)},match:function(e){t.handleMatchNote(e)}},t}return t=c,(n=[{key:"unload",value:function(){clearInterval(this.secondTicker)}},{key:"fetchOrder",value:(i=ho((function*(){var e=yield Ke("/api/order",this.orderID);ze().checkResponse(e)&&(this.order=e.order)})),function(){return i.apply(this,arguments)})},{key:"showCancel",value:function(){var e=this.order,t=this.page,n=e.qty-e.filled,r=rt(e)?ze().assets[e.quoteID]:ze().assets[e.baseID];t.cancelRemain.textContent=Ee.formatCoinValue(n,r.info.unitinfo),t.cancelUnit.textContent=r.info.unitinfo.conventional.unit.toUpperCase(),this.showForm(t.cancelForm)}},{key:"showForm",value:(o=ho((function*(e){this.currentForm=e;var t=this.page;Ee.hide(t.cancelForm),e.style.right="10000px",Ee.show(t.forms,e);var n=(t.forms.offsetWidth+e.offsetWidth)/2;yield Ee.animate(500,(function(t){e.style.right="".concat((1-t)*n,"px")}),"easeOutHard"),e.style.right="0px"})),function(e){return o.apply(this,arguments)})},{key:"submitCancel",value:(r=ho((function*(){var e=this.page,t=this.order,n={orderID:t.id,pw:e.cancelPass.value};e.cancelPass.value="";var r=ze().loading(e.cancelForm),o=yield Ke("/api/cancel",n);r(),ze().checkResponse(o)&&(e.status.textContent=ce(D),Ee.hide(e.forms),t.cancelling=!0)})),function(){return r.apply(this,arguments)})},{key:"handleOrderNote",value:function(e){var t=e.order,n=this.page.cancelBttn;n&&t.id===this.orderID&&(n&&t.status>2&&Ee.hide(n),this.page.status.textContent=ot(t));var r,o=so(t.matches||[]);try{for(o.s();!(r=o.n()).done;){var i=r.value;this.processMatch(i)}}catch(e){o.e(e)}finally{o.f()}}},{key:"handleMatchNote",value:function(e){e.orderID===this.orderID&&this.processMatch(e.match)}},{key:"processMatch",value:function(e){for(var t,n=0,r=Array.from(this.page.matchBox.querySelectorAll(".match-card"));n<r.length;n++){var o=r[n];if(o.dataset.matchID===e.matchID){t=o;break}}if(t){var i=function(e,n,r){if(r){Ee.show(Ee.tmplElement(t,e));var o=Ee.tmplElement(t,n);o.textContent=r.stringID,o.dataset.explorerCoin=r.stringID,bo(o)}};i("swap","swapCoin",e.swap),i("counterSwap","counterSwapCoin",e.counterSwap),i("redeem","redeemCoin",e.redeem),i("counterRedeem","counterRedeemCoin",e.counterRedeem),i("refund","refundCoin",e.refund);var a=Ee.tmplElement(t,"swapMsg"),s=Ee.tmplElement(t,"counterSwapMsg");!function(e){return 1===e.side&&1===e.status||0===e.side&&2===e.status}(e)?function(e){return 0===e.side&&1===e.status||1===e.side&&2===e.status}(e)?(a.textContent=wo(e.swap),Ee.hide(Ee.tmplElement(t,"counterSwapMsg")),Ee.show(a)):Ee.hide(a,s):(s.textContent=wo(e.counterSwap),Ee.hide(Ee.tmplElement(t,"swapMsg")),Ee.show(s)),Ee.tmplElement(t,"status").textContent=function(e,t){switch(e){case 0:return"(0 / 4) Newly Matched";case 1:return"(1 / 4) First Swap Sent";case 2:return"(2 / 4) Second Swap Sent";case 3:return 0===t?"Match Complete":"(3 / 4) Maker Redeemed";case 4:return"Match Complete"}return"Unknown Order Status"}(e.status,e.side)}}}])&&fo(t.prototype,n),c}(He);function wo(e){return e.confs?"".concat(e.confs.count," / ").concat(e.confs.required," confirmations"):""}function bo(e){var t=xo[parseInt(e.dataset.explorerId)];if(t){var n=t[vo];n&&(e.classList.remove("plainlink"),e.classList.add("subtlelink"),e.href=n(e.dataset.explorerCoin))}}var ko,xo={42:(Jr={},io(Jr,0,(function(e){var t=ao(e.split(":"),2),n=t[0],r=t[1];return"https://explorer.dcrdata.org/tx/".concat(n,"/out/").concat(r)})),io(Jr,1,(function(e){var t=ao(e.split(":"),2),n=t[0],r=t[1];return"https://testnet.dcrdata.org/tx/".concat(n,"/out/").concat(r)})),Jr),0:(eo={},io(eo,0,(function(e){return"https://bitaps.com/".concat(e.split(":")[0])})),io(eo,1,(function(e){return"https://tbtc.bitaps.com/".concat(e.split(":")[0])})),eo),2:(to={},io(to,0,(function(e){return"https://ltc.bitaps.com/".concat(e.split(":")[0])})),io(to,1,(function(e){return"https://tltc.bitaps.com/".concat(e.split(":")[0])})),to)};function Co(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function So(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Fo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ao(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Eo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ao(i,r,o,a,s,"next",e)}function s(e){Ao(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Oo(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Fo(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Fo(e,t){if(e){if("string"==typeof e)return Ro(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ro(e,t):void 0}}function Ro(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var To=Ee.idel,Do=Ee.bind,Po=Ee.unbind,Lo="loggers",Bo="recorders",Wo={login:Nt,register:Lt,markets:Pr,wallets:nn,settings:dn,orders:no,order:go},qo=["register","login","settings"],Mo=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.notes=[],this.pokes=[],this.user={accounts:{},wallets:{}},this.commitHash="a60275a159f670757d78d305fe840b72ffc05419",this.showPopups="1"===Ue.getCookie("popups"),console.log("Decred DEX Client App, Build",this.commitHash.substring(0,7)),this.loggers=Ue.fetch(Lo)||{},window.enableLogger=function(e,n){return n?t.loggers[e]=!0:delete t.loggers[e],Ue.store(Lo,t.loggers),"".concat(e," logger ").concat(n?"enabled":"disabled")},window.log=function(){t.log.apply(t,arguments)};var n=Ue.fetch(Bo)||[];this.recorders={};var r,o=Oo(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;console.log("recording",i),this.recorders[i]=[]}}catch(e){o.e(e)}finally{o.f()}window.recordLogger=function(e,n){return n?t.recorders[e]=[]:delete t.recorders[e],Ue.store(Bo,Object.keys(t.recorders)),"".concat(e," recorder ").concat(n?"enabled":"disabled")},window.dumpLogger=function(e){var n=t.recorders[e];if(!n)return"no recorder for logger ".concat(e);var r=document.createElement("a");r.href="data:application/octet-stream;base64,".concat(window.btoa(JSON.stringify(n,null,4))),r.download="".concat(e,".json"),document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r)}),0)},s=se[document.documentElement.lang.toLowerCase()]}var t,n,r,o,i,a,l;return t=e,(n=[{key:"start",value:(l=Eo((function*(){var e=this;Do(window,"popstate",(function(t){var n=t.state.page;(n||""===n)&&e.loadPage(n,t.state.data,!0)})),this.main=To(document,"main");var t=this.main.dataset.handler;yield this.fetchUser();var n=new URL(window.location);_o(n.pathname)!==t&&(n.pathname="/".concat(t),n.search="",window.history.replaceState({page:t},"",n)),this.attachHeader(),this.attachCommon(this.header),this.attach();var r,o=Ue.fetch("notifications");this.setNotes(o||[]),rr.connect((r="https:"===window.location.protocol?"wss":"ws","".concat(r,"://").concat(window.location.host,"/ws")),this.reconnected),rr.registerRoute("notify",(function(t){e.notify(t)}))})),function(){return l.apply(this,arguments)})},{key:"reconnected",value:function(){window.location.reload()}},{key:"fetchUser",value:(a=Eo((function*(){var e=yield function(e){return $e.apply(this,arguments)}("/api/user"),t=qo.indexOf(this.main.dataset.handler)>-1;if(this.checkResponse(e,t)){this.user=e,this.assets=e.assets,this.exchanges=e.exchanges,this.walletMap={},this.locale=e.locale;for(var n=0,r=Object.entries(e.assets);n<r.length;n++){var o=So(r[n],2),i=o[0],a=o[1];a.wallet&&(this.walletMap[i]=a.wallet)}return this.updateMenuItemsDisplay(),e}})),function(){return a.apply(this,arguments)})},{key:"loadPage",value:(i=Eo((function*(e,t,n){this.tooltip.style.left="-10000px",Ee.hide(this.page.noteBox,this.page.profileBox);var r=new URL("/".concat(e),window.location.origin),o=_o(e),i=yield window.fetch(r);if(!i.ok)return!1;var a=yield i.text(),s=Ee.noderize(a),l=To(s,"main"),c=l.dataset.handler;if(!n){var u=c===o?r.toString():"/".concat(c);window.history.pushState({page:e,data:t},c,u)}return document.title=s.title,this.main.replaceWith(l),this.main=l,this.attach(t),!0})),function(e,t,n){return i.apply(this,arguments)})},{key:"attach",value:function(e){var t=this.main.dataset.handler;if(t){this.attachCommon(this.main),this.loadedPage&&this.loadedPage.unload();var n=Wo[t];this.loadedPage=n?new n(this.main,e):null,this.bindTooltips(this.main)}else console.error("cannot attach to content with no specified handler")}},{key:"bindTooltips",value:function(e){var t=this;e.querySelectorAll("[data-tooltip]").forEach((function(e){Do(e,"mouseenter",(function(){t.tooltip.textContent=e.dataset.tooltip;var n=Ee.layoutMetrics(e),r=n.centerX-t.tooltip.offsetWidth/2;r<0&&(r=5),r+t.tooltip.offsetWidth>document.body.offsetWidth&&(r=document.body.offsetWidth-t.tooltip.offsetWidth-5),t.tooltip.style.left="".concat(r,"px"),t.tooltip.style.top="".concat(n.bodyTop-t.tooltip.offsetHeight-5,"px")})),Do(e,"mouseleave",(function(){t.tooltip.style.left="-10000px"}))}))}},{key:"attachHeader",value:function(){var e=this;this.header=To(document.body,"header"),this.popupNotes=To(document.body,"popupNotes"),this.popupTmpl=Ee.tmplElement(this.popupNotes,"note"),this.popupTmpl.remove(),this.tooltip=To(document.body,"tooltip");var t=this.page=Ee.idDescendants(this.header);delete t.noteTmpl.id,t.noteTmpl.remove(),delete t.pokeTmpl.id,t.pokeTmpl.remove(),t.loader.remove(),Ee.show(t.loader),Do(t.noteMenuEntry,"click",Eo((function*(){Ee.hide(t.pokeList),Ee.show(t.noteList),e.ackNotes(),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),e.showDropdown(t.noteMenuEntry,t.noteBox),Ee.hide(t.noteIndicator);var n,r=Oo(e.notes);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.acked&&o.el.classList.remove("firstview")}}catch(e){r.e(e)}finally{r.f()}e.setNoteTimes(t.noteList),e.setNoteTimes(t.pokeList),e.storeNotes()}))),Do(t.profileMenuEntry,"click",(function(){e.showDropdown(t.profileMenuEntry,t.profileBox)})),Do(t.innerNoteIcon,"click",(function(){Ee.hide(t.noteBox)})),Do(t.innerProfileIcon,"click",(function(){Ee.hide(t.profileBox)})),Do(t.profileSignout,"click",function(){var t=Eo((function*(t){return yield e.signOut()}));return function(e){return t.apply(this,arguments)}}()),Do(t.pokeCat,"click",(function(){e.setNoteTimes(t.pokeList),t.pokeCat.classList.add("active"),t.noteCat.classList.remove("active"),Ee.hide(t.noteList),Ee.show(t.pokeList),e.ackNotes()})),Do(t.noteCat,"click",(function(){e.setNoteTimes(t.noteList),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),Ee.hide(t.pokeList),Ee.show(t.noteList),e.ackNotes()}))}},{key:"showDropdown",value:function(e,t){var n=this,r=e.getBoundingClientRect();Ee.hide(this.page.noteBox,this.page.profileBox),Ee.show(t),t.style.right="".concat(window.innerWidth-r.left-r.width+11,"px"),t.style.top="".concat(r.top-9,"px"),Do(document,"click",(function e(r){Ee.mouseInElement(r,t)||(Ee.hide(t),Po(document,"click",e),t===n.page.noteBox&&Ee.isDisplayed(n.page.noteList)&&n.ackNotes())}))}},{key:"ackNotes",value:function(){var e,t=[],n=Oo(this.notes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.acked?r.el.classList.remove("firstview"):(r.acked=!0,r.id&&r.severity>2&&t.push(r.id))}}catch(e){n.e(e)}finally{n.f()}t.length&&rr.request("acknotes",t),Ee.hide(this.page.noteIndicator)}},{key:"setNoteTimes",value:function(e){for(var t=0,n=Array.from(e.children);t<n.length;t++){var r=n[t];r.querySelector("span.note-time").textContent=Ee.timeSince(r.note.stamp)}}},{key:"bindInternalNavigation",value:function(e){var t=this,n=new URL(window.location);e.querySelectorAll("a").forEach((function(e){if(e.href){var r=new URL(e.href);if(r.origin===n.origin){var o=r.pathname.substring(1),i={};r.search&&r.searchParams.forEach((function(e,t){i[t]=e})),Ee.bind(e,"click",(function(e){e.preventDefault(),t.loadPage(o,i)}))}}}))}},{key:"storeNotes",value:function(){Ue.store("notifications",this.notes.map((function(e){return{subject:e.subject,details:e.details,severity:e.severity,stamp:e.stamp,id:e.id,acked:e.acked}})))}},{key:"updateMenuItemsDisplay",value:function(){var e=this.page;e&&(this.user.authed?(Ee.show(e.noteMenuEntry,e.walletsMenuEntry,e.profileMenuEntry),Object.keys(this.user.exchanges).length>0?Ee.show(e.marketsMenuEntry):Ee.hide(e.marketsMenuEntry)):Ee.hide(e.noteMenuEntry,e.walletsMenuEntry,e.marketsMenuEntry,e.profileMenuEntry))}},{key:"attachCommon",value:function(e){this.bindInternalNavigation(e)}},{key:"updateExchangeRegistration",value:function(e,t,n,r){var o=this.exchanges[e];if(t)o.pendingFee=null;else{var i=this.assets[r].symbol;o.pendingFee={confs:n,asset:r,symbol:i}}}},{key:"handleFeePaymentNote",value:function(e){switch(e.topic){case"RegUpdate":this.updateExchangeRegistration(e.dex,!1,e.confirmations,e.asset);break;case"AccountRegistered":this.updateExchangeRegistration(e.dex,!0)}}},{key:"setNotes",value:function(e){this.log("notes","setNotes",e),this.notes=[],Ee.empty(this.page.noteList);for(var t=0;t<e.length;t++)this.prependNoteElement(e[t],!0);this.storeNotes()}},{key:"notify",value:function(e){switch(this.log("notes","notify",e),e.type){case"order":var t=e.order,n=this.user.exchanges[t.host].markets[t.market];n.orders?function(e,t){for(var n in e.orders||[])if(e.orders[n].id===t.id)return e.orders[n]=t,!0;return!1}(n,t)||n.orders.push(t):n.orders=[t];break;case"balance":var r=this.user.assets&&this.user.assets[e.assetID].wallet;r&&(r.balance=e.balance);break;case"feepayment":this.handleFeePaymentNote(e);break;case"walletstate":case"walletconfig":if(!this.assets)return;var o=e.wallet,i=this.assets[o.assetID];i.wallet=o,this.walletMap[o.assetID]=o,this.main.querySelectorAll('[data-balance-target="'.concat(o.assetID,'"]')).forEach((function(e){e.textContent=Ee.formatFullPrecision(o.balance.available,i.info.unitinfo)}));break;case"match":var a=this.order(e.orderID);a&&function(e,t){for(var n in e.matches)if(e.matches[n].matchID===t.matchID)return void(e.matches[n]=t);e.matches=e.matches||[],e.matches.push(t)}(a,e.match);break;case"conn":var s=this.user.exchanges[e.host];s&&(s.connected=e.connected);break;case"spots":for(var l=this.user.exchanges[e.host],c=0,u=Object.entries(e.spots);c<u.length;c++){var h=So(u[c],2),d=h[0],f=h[1];l.markets[d].spot=f}}if(this.loadedPage&&this.loadedPage.notify(e),!(e.severity<2)){if(this.showPopups){var p=this.popupTmpl.cloneNode(!0);Ee.tmplElement(p,"text").textContent="".concat(e.subject,": ").concat(e.details);var m=Ee.tmplElement(p,"indicator");2===e.severity?Ee.hide(m):Uo(m,e.severity);var y=this.popupNotes;for(y.appendChild(p);y.children.length>5;)y.removeChild(y.firstChild);setTimeout(Eo((function*(){yield Ee.animate(500,(function(e){p.style.opacity=1-e})),p.remove()})),6e3)}2===e.severity?this.prependPokeElement(e):this.prependNoteElement(e)}}},{key:"log",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.loggers[e]&&(t=console).log.apply(t,["".concat(No(),"[").concat(e,"]:")].concat(r)),this.recorders[e]&&this.recorders[e].push({time:No(),msg:r})}},{key:"prependPokeElement",value:function(e){for(this.pokes.push(e);this.pokes.length>100;)this.pokes.shift();var t=this.makePoke(e);this.prependListElement(this.page.pokeList,e,t)}},{key:"prependNoteElement",value:function(e,t){for(this.notes.push(e);this.notes.length>100;)this.notes.shift();var n=this.page.noteList,r=this.makeNote(e);if(this.prependListElement(n,e,r),t||this.storeNotes(),!(0===this.notes.length||Ee.isDisplayed(this.page.noteBox)&&Ee.isDisplayed(n))){var o=0,i=this.notes.reduce((function(e,t){return t.acked||o++,!t.acked&&t.severity>e?t.severity:e}),0),a=this.page.noteIndicator;Uo(a,i),o?(a.textContent=o>99?"".concat(99,"+"):o,Ee.show(a)):Ee.hide(a)}}},{key:"prependListElement",value:function(e,t,n){for(t.el=n,n.note=t,e.prepend(n);e.children.length>100;)e.removeChild(e.lastChild);this.setNoteTimes(e)}},{key:"makeNote",value:function(e){var t=this.page.noteTmpl.cloneNode(!0);if(e.severity>2){var n=3===e.severity?"good":4===e.severity?"warn":"bad";t.querySelector("div.note-indicator").classList.add(n)}return t.querySelector("div.note-subject").textContent=e.subject,t.querySelector("div.note-details").textContent=e.details,t}},{key:"makePoke",value:function(e){var t=this.page.pokeTmpl.cloneNode(!0),n=new Date(e.stamp);return Ee.tmplElement(t,"dateTime").textContent="".concat(n.toLocaleDateString(),", ").concat(n.toLocaleTimeString()),Ee.tmplElement(t,"details").textContent="".concat(e.subject,": ").concat(e.details),t}},{key:"loading",value:function(e){var t=this.page.loader.cloneNode(!0);return e.appendChild(t),function(){t.remove()}}},{key:"orders",value:function(e,t){var n=this.user.exchanges[e].markets[t].orders;return n||(n=[],this.user.exchanges[e].markets[t].orders=n),n}},{key:"order",value:function(e){for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++)for(var r=n[t],o=0,i=Object.values(r.markets);o<i.length;o++){var a=i[o];if(a.orders){var s,l=Oo(a.orders);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(c.id===e)return c}}catch(e){l.e(e)}finally{l.f()}}}}},{key:"unitInfo",value:function(e,t){var n=this.assets[e];return n?n.info.unitinfo:t.assets[e].unitInfo}},{key:"conventionalRate",value:function(e,t,n){var r=[this.unitInfo(e),this.unitInfo(t)],o=r[1],i=r[0].conventional.conversionFactor/o.conventional.conversionFactor;return n/et*i}},{key:"walletDefinition",value:function(e,t){var n=this.assets[e].info;return""===t?n.availablewallets[n.emptyidx]:n.availablewallets.filter((function(e){return e.type===t}))[0]}},{key:"currentWalletDefinition",value:function(e){return this.walletDefinition(e,this.assets[e].wallet.type)}},{key:"fetchBalance",value:(o=Eo((function*(e){var t=yield Ke("/api/balance",{assetID:e});if(!this.checkResponse(t))throw new Error("failed to fetch balance for asset ID ".concat(e));return t.balance})),function(e){return o.apply(this,arguments)})},{key:"checkResponse",value:function(e,t){return!(!e.requestSuccessful||!e.ok)||(this.user.inited&&!t&&this.notify(Ut(ce(Y),e.msg,5)),!1)}},{key:"signOut",value:(r=Eo((function*(){var e=yield Ke("/api/logout");this.checkResponse(e)?(Ue.clearAllStore(),Ue.removeAuthCK(),window.location.href="/login"):Ee.hide(this.page.profileBox)})),function(){return r.apply(this,arguments)})}])&&Io(t.prototype,n),e}(),jo=(Co(ko={},3,"good"),Co(ko,5,"bad"),Co(ko,4,"warn"),ko);function _o(e){return e.replace(/^\//,"").split("/")[0].split("?")[0].split("#")[0]}function No(){var e=new Date,t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0"),o=e.getMilliseconds().toString().padStart(3,"0");return"".concat(t,":").concat(n,":").concat(r,".").concat(o)}function Uo(e,t){e.classList.remove("bad","warn","good"),e.classList.add(jo[t])}var zo=new Mo;je=zo,zo.start()})();
//# sourceMappingURL=entry.js.map